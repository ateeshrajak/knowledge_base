# CVE-2009-1185

## CVE-2009-1185 (Udev < 1.4.1) 2.6.x  https://www.exploit-db.com/exploits/8478/
## Although online it is reported as a vulnerability only for 2.6.26 kernels
## it is actually working on more kernels, since it depends on the version of udev.

## Exploitation

We can check the udev version by doing:
udevinfo -V

To exploit this, we can just copy the entire exploit code at the link:
https://www.exploit-db.com/exploits/8478/

And save it in /tmp/udev.sh.
At this point we know we have to pass an argument to this exploit, and
this argument is a particular ID related to UDEV (which is generally PID
of UDEV - 1).

To do this we can do two things:

cat /proc/net/netlink  ;; give a look at the last number which is not 0

This number should be the (udev-PID - 1), and we can verify this by doing:
ps -aux | grep -i udev

Once we have done this double check, we can launch the script with this number,
note that we should launch it multiple times, indeed 
it may take up to 15/20 times to work sometimes.

So we have to launch:
./udev.sh $number
id 

Checking if we are root every time the exploit completes.

## References
http://www.madirish.net/node/399

